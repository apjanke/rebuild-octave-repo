# HG changeset patch
# User Thorsten Meyer <thorsten.meyier@gmx.de>
# Date 1235455021 18000
#      Tue Feb 24 00:57:01 2009 -0500
# Node ID 8b7e448d989cf018bbbf8e115f6201dd45aa8eb0
# Parent  7557cf34ffcdac64d8e25ad2e3cae59d96f3fdf2
Do not autogenerate Makefile from Makefile.in.

diff --git a/ChangeLog b/ChangeLog
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,8 +1,17 @@
+2009-02-24  Thorsten Meyer  <thorsten@hexe>
+
+	* Makefile.in: Rename to Makefile.
+	* configure.in: Remove Makefile from list of autogenerated
+	configuration files.
+	* octMakefile.in: Remove references to Makefile.in, add Makefile
+	to list of CONF_DISTFILES.
+	* octMakefile.in (maintainer-clean distclean): Don't delete Makefile.
+
 2009-02-17  Benjamin Lindner  <lindnerb@users.sourceforge.net>
 
 	* configure.in: Check for mkstemps on MinGW platform
 	(HAVE_MKSTEMPS): Define if mkstsmps is avilable in libiberty.
 
 2009-02-17  Jaroslav Hajek  <highegg@gmail.com>
 
 	* NEWS: Mention cummin and cummax
diff --git a/Makefile.in b/Makefile
rename from Makefile.in
rename to Makefile
diff --git a/configure.in b/configure.in
--- a/configure.in
+++ b/configure.in
@@ -2097,17 +2097,17 @@ typedef int sig_atomic_t;
 #define OCTAVE_EMPTY_CPP_ARG
 
 #include "oct-dlldefs.h"
 #include "oct-types.h"
 ])
 
 ### Do the substitutions in all the Makefiles.
 
-AC_CONFIG_FILES([Makefile octMakefile Makeconf test/Makefile
+AC_CONFIG_FILES([octMakefile Makeconf test/Makefile
   doc/Makefile doc/faq/Makefile doc/interpreter/Makefile
   doc/liboctave/Makefile doc/refcard/Makefile emacs/Makefile
   examples/Makefile examples/@polynomial/Makefile liboctave/Makefile
   liboctave/oct-types.h src/Makefile src/mxarray.h libcruft/Makefile
   libcruft/Makerules libcruft/amos/Makefile libcruft/blas/Makefile
   libcruft/daspk/Makefile libcruft/dasrt/Makefile
   libcruft/dassl/Makefile libcruft/fftpack/Makefile
   libcruft/lapack/Makefile 
diff --git a/octMakefile.in b/octMakefile.in
--- a/octMakefile.in
+++ b/octMakefile.in
@@ -28,24 +28,22 @@ VPATH = @srcdir@
 
 include $(TOPDIR)/Makeconf
 
 INSTALL = @INSTALL@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
 INSTALL_DATA = @INSTALL_DATA@
 
-BUILT_CONF_DISTFILES = Makefile
-
-CONF_DISTFILES = Makefile.in octMakefile.in Makeconf.in \
+CONF_DISTFILES = Makefile octMakefile.in Makeconf.in \
 	configure configure.in config.guess config.sub aclocal.m4 \
 	acx_blas.m4 acx_lapack.m4 acx_blas_f77_func.m4 \
 	config.h.in install-sh autogen.sh
 
-BUILT_DISTFILES = $(BUILT_CONF_DISTFILES) BUGS INSTALL.OCTAVE
+BUILT_DISTFILES = BUGS INSTALL.OCTAVE
 
 DISTFILES = $(CONF_DISTFILES) \
 	COPYING INSTALL NEWS \
 	NEWS.[0-9] PROJECTS README README.Linux README.Windows \
 	README.Cygwin README.MSVC README.kpathsea ROADMAP SENDING-PATCHES \
 	move-if-change octave-sh octave-bug.in \
 	octave-config.in missing mk-opts.pl mkinstalldirs \
 	mkoctfile.in run-octave.in ChangeLog ChangeLog.[0-9]
@@ -158,17 +156,17 @@ install install-strip uninstall tags TAG
 	$(foreach d, $(INSTALL_SUBDIRS), $(do-subdir-for-command))
 .PHONY: install install-strip uninstall tags
 
 clean mostlyclean distclean maintainer-clean::
 	$(foreach d, $(CLEANSUBDIRS), $(do-subdir-for-command))
 .PHONY: clean mostlyclean distclean maintainer-clean
 
 maintainer-clean distclean::
-	rm -f octMakefile Makefile Makeconf
+	rm -f octMakefile Makeconf
 	rm -f config.cache config.h config.log config.status
 	rm -rf autom4te.cache
 	rm -f $(SHELL_SCRIPTS)
 	rm -f unistd.h
 
 maintainer-clean::
 	rm -f configure config.h.in BUGS INSTALL.OCTAVE
 
@@ -234,17 +232,16 @@ snapshot: snapshot-version
 
 # Rules for making a dist of just the stuff needed to run configure.
 
 conf-dist:
 	echo config-dist-$(version) > .fname
 	rm -rf `cat .fname`
 	mkdir `cat .fname`
 	ln $(CONF_DISTFILES) `cat .fname`
-	ln $(BUILT_CONF_DISTFILES) `cat .fname`
 	for dir in $(CONF_DISTSUBDIRS); do \
 	  mkdir `cat .fname`/$$dir; \
 	  $(MAKE) -C $$dir conf-dist; \
 	done
 	tar chf `cat .fname`.tar `cat .fname`
 	rm -rf `cat .fname`
 	gzip --best `cat .fname`.tar
 	rm -f .fname
