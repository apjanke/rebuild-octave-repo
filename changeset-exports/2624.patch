# HG changeset patch
# User jwe
# Date 854253610 0
#      Sun Jan 26 04:40:10 1997 +0000
# Node ID 7e24c1f29db4de3126965f1f86580362a35c8182
# Parent  e7e72101b86c15fcd71586fce1ca6e1a8761fa37
[project @ 1997-01-26 04:40:00 by jwe]

diff --git a/ChangeLog b/ChangeLog
--- a/ChangeLog
+++ b/ChangeLog
@@ -1,8 +1,14 @@
+Sat Jan 25 22:27:14 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in (bin-dist): New target.
+
+	* install-octave: Rename from doinstall.sh.  Update for 2.x.
+
 Wed Jan 22 11:14:07 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* aclocal.m4 (ld_run_path): Anchor search at beginning of line to
 	avoid GNU sed bug on HP-UX systems.  Use just one sed command.
 
 	* emacs/octave-hlp.el, emacs/octave-inf.el, emacs/octave-mod.el:
 	New files from Kurt Hornik.
 	* emacs/octave.el: Delete.
diff --git a/Makefile.in b/Makefile.in
--- a/Makefile.in
+++ b/Makefile.in
@@ -32,18 +32,18 @@ all: FORCE
 	$(MAKE) -f octMakefile all
 
 # plplot should go in TARGETS if we start distributing it.
 
 TARGETS = octave-bug mkoctfile libcruft liboctave kpathsea info dlfcn \
 	src scripts doc check octave.info INSTALL.OCTAVE BUGS \
 	install uninstall tags TAGS clean-tar dist-z links-for-dist \
 	dist-tar clean-dist-tar dist links-for-bin-dist bin-dist-tar \
-	clean-bin-dist-tar binary-dist conf-dist snapshot-z snapshot \
-	snapshot-version
+	clean-bin-dist-tar binary-dist bin-dist conf-dist \
+	snapshot-z snapshot snapshot-version
 
 NO_DEP_TARGETS = clean mostlyclean distclean maintainer-clean
 
 ALL_TARGETS = $(TARGETS) $(NO_DEP_TARGETS)
 
 $(TARGETS): FORCE
 	$(MAKE) -f octMakefile $@
 
diff --git a/doc/ChangeLog b/doc/ChangeLog
--- a/doc/ChangeLog
+++ b/doc/ChangeLog
@@ -1,8 +1,13 @@
+Sat Jan 25 22:32:33 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in, interpreter/Makefile.in, liboctave/Makefile.in,
+	faq/Makefile.in, refcard/Makefile.in (bin-dist): New target.
+
 Tue Jan  7 00:17:24 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* Version 2.0.1 released.
 
 Tue Dec 10 01:43:13 1996  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* Version 2.0 released.
 
diff --git a/doc/Makefile.in b/doc/Makefile.in
--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -21,16 +21,18 @@ INSTALL_DATA = @INSTALL_DATA@
 SOURCES =
 
 DISTFILES = Makefile.in ChangeLog conf.texi.in texinfo.tex 
 
 SUBDIRS = faq interpreter liboctave refcard
 
 DISTSUBDIRS = $(SUBDIRS)
 
+BINDISTSUBDIRS = $(SUBDIRS)
+
 all: $(SUBDIRS)
 .PHONY: all
 
 ../INSTALL.OCTAVE:
 	cd interpreter ; $(MAKE) ../../INSTALL.OCTAVE
 
 ../BUGS:
 	cd interpreter ; $(MAKE) ../../BUGS
@@ -58,8 +60,12 @@ distclean::
 
 maintainer-clean::
 	rm -f tags TAGS Makefile
 
 dist:
 	ln $(DISTFILES) ../`cat ../.fname`/doc
 	for dir in $(DISTSUBDIRS); do mkdir ../`cat ../.fname`/doc/$$dir; cd $$dir; $(MAKE) $@; cd ..; done
 .PHONY: dist
+
+bin-dist:
+	for dir in $(BINDISTSUBDIRS); do mkdir ../`cat ../.fname`/doc/$$dir; cd $$dir; $(MAKE) $@; cd ..; done
+.PHONY: bin-dist
diff --git a/doc/faq/Makefile.in b/doc/faq/Makefile.in
--- a/doc/faq/Makefile.in
+++ b/doc/faq/Makefile.in
@@ -21,16 +21,18 @@ INSTALL_DATA = @INSTALL_DATA@
 SOURCES =
 
 TEXINFO := FAQ.texi
 
 FORMATTED := FAQ.info FAQ.dvi FAQ.ps
 
 DISTFILES := Makefile.in $(TEXINFO) $(FORMATTED)
 
+BINDISTFILES =
+
 SPELL := $(patsubst %.texi, %.spell, $(ALL_TEXINFO))
 
 %.spell : %.texi
 	rm -f $@
 	sed -e 's/@@/ at /g' -e 's/@[a-zA-Z]*//g' $< | spell > $@.tmp
 	mv $@.tmp $@
 
 all: FAQ.info FAQ.dvi FAQ.ps
@@ -65,8 +67,14 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS FAQ.info FAQ.info-* FAQ.dvi FAQ.ps
 .PHONY: maintainer-clean
 
 dist: all
 	ln $(DISTFILES) ../../`cat ../../.fname`/doc/faq
 .PHONY: dist
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../../`cat ../../.fname`/doc/faq ; \
+	fi
+.PHONY: bin-dist
diff --git a/doc/interpreter/Makefile.in b/doc/interpreter/Makefile.in
--- a/doc/interpreter/Makefile.in
+++ b/doc/interpreter/Makefile.in
@@ -26,21 +26,33 @@ TEXINFO = amuse.texi arith.texi audio.te
 	history.texi hsuser.texi image.texi in-idx.texi install.texi \
 	install1.texi intro.texi invoke.texi io.texi linalg.texi \
 	matrix.texi nonlin.texi octave.texi op-idx.texi optim.texi \
 	plot.texi poly.texi preface.texi program.texi quad.texi \
 	rd-idx.texi rluser.texi set.texi signal.texi special.texi \
 	stats.texi stmt.texi strings.texi system.texi var.texi \
 	vr-idx.texi
 
-FORMATTED =  octave.dvi octave.ps octave.info octave.info-[0-9]*
+FORMATTED = octave.dvi octave.ps octave.info octave.info octave.info-[0-9]*
 
 DISTFILES = Makefile.in dir octave.1 conf.texi gpl.texi \
 	$(TEXINFO) $(FORMATTED)
 
+ifeq ($(wildcard octave.info), )
+  BINDISTFILES = $(srcdir)/octave.1 $(srcdir)/octave.info \
+	$(wildcard $(srcdir)/octave.info-[0-9]*)
+else
+  BINDISTFILES = $(srcdir)/octave.1 octave.info octave.info-[0-9]*
+endif
+
+# Look for version.h to get version information.
+xfiles := $(TOPDIR)/src/version.h $(srcdir)/$(TOPDIR)/src/version.h
+
+version_file := $(firstword $(foreach file, $(xfiles), $(wildcard $(file))))
+
 SPELL = $(patsubst %.texi, %.spell, $(ALL_TEXINFO))
 
 %.spell : %.texi
 	rm -f $@
 	sed -e 's/@@/ at /g' -e 's/@[a-zA-Z]*//g' $< | spell > $@.tmp
 	mv $@.tmp $@
 
 all: conf.texi octave.info octave.dvi octave.ps
@@ -157,8 +169,14 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS octave.info octave.info-* octave.dvi octave.ps \
 .PHONY: maintainer-clean
 
 dist: all
 	ln $(DISTFILES) ../../`cat ../../.fname`/doc/interpreter
 .PHONY: dist
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../../`cat ../../.fname`/doc/interpreter ; \
+	fi
+.PHONY: bin-dist
diff --git a/doc/liboctave/Makefile.in b/doc/liboctave/Makefile.in
--- a/doc/liboctave/Makefile.in
+++ b/doc/liboctave/Makefile.in
@@ -24,16 +24,18 @@ TEXINFO = array.texi bugs.texi cp-idx.te
 	factor.texi fn-idx.texi install.texi intro.texi liboctave.texi \
 	matvec.texi nleqn.texi ode.texi optim.texi preface.texi \
 	quad.texi range.texi
 
 FORMATTED = liboctave.dvi liboctave.ps liboctave.info liboctave.info-[0-9]*
 
 DISTFILES = Makefile.in conf.texi gpl.texi $(TEXINFO) $(FORMATTED)
 
+BINDISTFILES =
+
 SPELL = $(patsubst %.texi, %.spell, $(TEXINFO))
 
 %.spell : %.texi
 	rm -f $@
 	sed -e 's/@@/ at /g' -e 's/@[a-zA-Z]*//g' $< | spell > $@.tmp
 	mv $@.tmp $@
 
 all: conf.texi liboctave.info liboctave.dvi liboctave.ps
@@ -103,8 +105,14 @@ distclean: clean
 maintainer-clean: distclean
 	rm -f tags TAGS liboctave.info liboctave.info-* \
 	liboctave.dvi liboctave.ps
 .PHONY: maintainer-clean
 
 dist: all
 	ln $(DISTFILES) ../../`cat ../../.fname`/doc/liboctave
 .PHONY: dist
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../../`cat ../../.fname`/doc/liboctave ; \
+	fi
+.PHONY: bin-dist
diff --git a/doc/refcard/Makefile.in b/doc/refcard/Makefile.in
--- a/doc/refcard/Makefile.in
+++ b/doc/refcard/Makefile.in
@@ -21,16 +21,18 @@ INSTALL_DATA = @INSTALL_DATA@
 TEX := refcard.tex refcard-a4.tex refcard-legal.tex refcard-letter.tex 
 
 FORMATTED := refcard-a4.dvi refcard-a4.ps \
 	refcard-legal.dvi refcard-legal.ps \
 	refcard-letter.dvi refcard-letter.ps
 
 DISTFILES := Makefile.in $(TEX) $(FORMATTED)
 
+BINDISTFILES = $(addprefix $(srcdir)/, $(TEX) $(FORMATTED))
+
 all: $(FORMATTED)
 
 refcard-a4.dvi: refcard-a4.tex refcard.tex
 	-TEXINPUTS="$(srcdir):$(TEXINPUTS):" ; export TEXINPUTS ; \
 	  tex $(srcdir)/refcard-a4.tex
 
 refcard-a4.ps: refcard-a4.dvi
 	-dvips -T 297mm,210mm -o refcard-a4.ps refcard-a4.dvi
@@ -64,8 +66,14 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS	refcard-*.dvi refcard-*.ps
 .PHONY: maintainer-clean
 
 dist: all
 	ln $(DISTFILES) ../../`cat ../../.fname`/doc/refcard
 .PHONY: dist
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../../`cat ../../.fname`/doc/refcard ; \
+	fi
+.PHONY: bin-dist
diff --git a/examples/Makefile.in b/examples/Makefile.in
--- a/examples/Makefile.in
+++ b/examples/Makefile.in
@@ -13,19 +13,23 @@ top_srcdir = @top_srcdir@
 VPATH = @srcdir@
 
 include $(TOPDIR)/Makeconf
 
 INSTALL = @INSTALL@
 INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 
-SOURCES = hello.cc make_int.cc info-emacs-info info-emacs-octave-help
+SCRIPTS = info-emacs-info info-emacs-octave-help
+
+SOURCES = hello.cc make_int.cc
 
-DISTFILES = Makefile.in $(SOURCES)
+DISTFILES = Makefile.in $(SOURCES) $(SCRIPTS)
+
+BINDISTFILES = $(addprefix $(srcdir)/, $(SCRIPTS))
 
 SUBDIRS = 
 
 DISTSUBDIRS = 
 
 all:
 .PHONY: all
 
@@ -47,8 +51,14 @@ distclean:
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../`cat ../.fname`/examples
 .PHONY: dist
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/examples ; \
+	fi
+.PHONY: bin-dist
diff --git a/info/ChangeLog b/info/ChangeLog
--- a/info/ChangeLog
+++ b/info/ChangeLog
@@ -1,8 +1,12 @@
+Sat Jan 25 22:33:43 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in (bin-dist): New target.
+
 Sat Jan 18 15:57:49 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* Makefile.in (MAKEDOC_OBJECTS): Also include $(LIBOBJS).
 
 Wed Jan 15 14:52:23 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* Makefile.in (LIBOBJS): Allow substitution.
 	(SRCS): Add memcpy.c, memmove.c, and strdup.c to the list.
diff --git a/info/Makefile.in b/info/Makefile.in
--- a/info/Makefile.in
+++ b/info/Makefile.in
@@ -1,10 +1,10 @@
 # Makefile for texinfo/info.	-*- Indented-Text -*-
-# $Id: Makefile.in,v 1.37 1997-01-20 17:25:41 jwe Exp $
+# $Id: Makefile.in,v 1.38 1997-01-26 04:40:02 jwe Exp $
 # 
 # Copyright (C) 1993,96 Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
 # the Free Software Foundation; either version 2, or (at your option)
 # any later version.
 
@@ -102,16 +102,18 @@ infofiles = info.info info-stnd.info
 
 TEXINFO = info.texi info-stnd.texi
 
 DVI = info.dvi info-stnd.dvi
 
 DISTFILES = Makefile.in ChangeLog README NEWS info.1 configure.in \
   configure mkinstalldirs $(SRCS) $(HDRS) $(infofiles) $(TEXINFO) $(DVI)
 
+BINDISTFILES = info
+
 %.o : %.c
 	$(CC) -c $(CPPFLAGS) $(LDEFS) $(DEFS) -I. -I$(srcdir) $(CFLAGS) $<
 
 all: info $(infofiles)
 sub-all: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(archlibdir)
@@ -155,16 +157,22 @@ mostlyclean: clean
 
 realclean: distclean
 	$(RM) info.info info-stnd.info
 
 dist: all-info all-dvi
 	ln $(DISTFILES) ../`cat ../.fname`/info
 .PHONY: dist
 
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/info ; \
+	fi
+.PHONY: bin-dist
+
 TAGS: $(SRCS) makedoc-TAGS
 	etags $(SRCS)
 	cat makedoc-TAGS >>TAGS && $(RM) makedoc-TAGS
 
 makedoc-TAGS: $(CMDFILES)
 	./makedoc -tags $(CMDFILES) >makedoc-TAGS
 
 texclean:
diff --git a/kpathsea/ChangeLog b/kpathsea/ChangeLog
--- a/kpathsea/ChangeLog
+++ b/kpathsea/ChangeLog
@@ -1,8 +1,12 @@
+Sat Jan 25 22:33:56 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in (bin-dist): New target.
+
 Thu Dec  5 18:59:44 1996  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* config.sub: Update to current version from FSF.
 
 Sun Nov  3 15:35:46 1996  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* c-std.h: Use #ifdef, not #if to checm HAVE_STDLIB_H
 	* c-unistd.h: Likewise, for HAVE_UNISTD_H
diff --git a/kpathsea/Makefile.in b/kpathsea/Makefile.in
--- a/kpathsea/Makefile.in
+++ b/kpathsea/Makefile.in
@@ -32,16 +32,21 @@ progname.o putenv.o readable.o rm-suffix
 tex-glyph.o tex-make.o tilde.o truncate.o uppercasify.o variable.o       \
 version.o xcalloc.o xfopen.o xmalloc.o xopendir.o xputenv.o xrealloc.o   \
 xstat.o xstrdup.o $(malloc)
 
 LIBS_TO_INSTALL = libkpathsea.a
 
 SH_LIBS_TO_INSTALL = libkpathsea.$(SHLEXT)
 
+ifeq ($(SHARED_LIBS), true)
+  BINDISTFILES = libkpathsea.$(SHLEXT)
+  BINDISTLIBS = $(addprefix kpathsea/, libkpathsea.$(SHLEXT))
+endif
+
 default all: stamp-picdir kpsewhich MakeTeXPK kpathsea.info stamp-shared
 
 stamp-picdir:
 	if [ -n "$(CPICFLAG)" ]; then \
 	  if [ -d pic ]; then true; else mkdir pic ; fi ; \
 	else true; fi
 	touch stamp-picdir
 
@@ -192,16 +197,23 @@ distdir: INSTALL TAGS kpathsea.info kpat
 	ln $(ln_files) $(distdir)
 	cp -p $(HOME)/gnu/gnuorg/*.texi $(distdir)
 	touch *.info*
 	ln *.info* *.texi kpathsea.aux kpathsea.cps $(distdir)
 	ln CONFIGURE HIER common.ac $(distdir)
 	cd $(distdir); rm -f paths.h
 	cd $(distdir); add-version $(version) version.c
 
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/kpathsea ; \
+	fi
+	echo $(BINDISTLIBS) >> ../`cat ../.fname`/LIBRARIES
+.PHONY: bin-dist
+
 ac_include ../make/config.make
 
 info: kpathsea.info
 dvi: kpathsea.dvi
 INSTALL: kpathsea.texi install.texi
 	$(MAKEINFO) $(MAKEINFO_FLAGS) --no-headers $< -o - \
 	  | sed -n -e '/^Installation/,/wrong fonts/'p >$@
 	add-info-toc $@
diff --git a/libcruft/ChangeLog b/libcruft/ChangeLog
--- a/libcruft/ChangeLog
+++ b/libcruft/ChangeLog
@@ -1,8 +1,18 @@
+Sat Jan 25 22:34:10 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in, balgen/Makefile.in, blas/Makefile.in,
+	cfsqp/Makefile.in, dassl/Makefile.in, eispack/Makefile.in,
+	fftpack/Makefile.in, fsqp/Makefile.in, lapack/Makefile.in,
+	linpack/Makefile.in, minpack/Makefile.in, misc/Makefile.in,
+	npsol/Makefile.in, odepack/Makefile.in, qpsol/Makefile.in,
+	quadpack/Makefile.in, ranlib/Makefile.in, slatec-fn/Makefile.in,
+	villad/Makefile.in (bin-dist): New target.
+
 Wed Jan 22 15:03:33 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* misc/Makefile.in (pic/machar.o): Add $(CPICFLAG) for this target.
 
 	* misc/d1mach.f (d1mach): Move SAVE statement ahead of DATA statment.
 
 Wed Jan 15 21:04:29 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
diff --git a/libcruft/Makefile.in b/libcruft/Makefile.in
--- a/libcruft/Makefile.in
+++ b/libcruft/Makefile.in
@@ -27,16 +27,21 @@ INSTALL_DATA = @INSTALL_DATA@
 CRUFT_DIRS = balgen blas dassl eispack fftpack fsqp lapack linpack \
 	minpack misc npsol odepack qpsol quadpack ranlib slatec-fn \
 	villad
 
 SUBDIRS = $(CRUFT_DIRS)
 
 DISTFILES = Makefile.in ChangeLog Makerules.in $(SOURCES) STOP.patch
 
+ifeq ($(SHARED_LIBS), true)
+  BINDISTFILES = libcruft.$(SHLEXT)
+  BINDISTLIBS = $(addprefix libcruft/, libcruft.$(SHLEXT))
+endif
+
 all: $(SUBDIRS) stamp-shared
 .PHONY: all
 
 $(SUBDIRS):
 	echo making all in $@
 	cd $@; $(MAKE) all
 .PHONY: $(SUBDIRS)
 
@@ -112,8 +117,15 @@ distclean::
 maintainer-clean::
 	rm -f *.a *.o Makefile Makerules so_locations tags TAGS
 	if $(SHARED_LIBS); then rm -f *.$(SHLEXT); fi
 
 dist:
 	for dir in $(SUBDIRS); do mkdir ../`cat ../.fname`/libcruft/$$dir; cd $$dir; $(MAKE) $@; cd ..; done
 	ln $(DISTFILES) ../`cat ../.fname`/libcruft
 .PHONY: dist
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/libcruft ; \
+	fi
+	echo $(BINDISTLIBS) >> ../`cat ../.fname`/LIBRARIES
+.PHONY: bin-dist
diff --git a/libcruft/misc/Makefile.in b/libcruft/misc/Makefile.in
--- a/libcruft/misc/Makefile.in
+++ b/libcruft/misc/Makefile.in
@@ -49,9 +49,9 @@ uninstall::
 
 XCC = $(patsubst -O%, , $(CC))
 XALL_CFLAGS = $(patsubst -O%, , $(ALL_CFLAGS))
 
 machar.o: $(srcdir)/machar.c
 	$(XCC) -c $(CPPFLAGS) $(XALL_CFLAGS) -DDP $<
 
 pic/machar.o: $(srcdir)/machar.c
-	$(XCC) -c $(CPPFLAGS) $(XALL_CFLAGS) -DDP $< -o $@
+	$(XCC) -c $(CPPFLAGS) $(CPICFLAG) $(XALL_CFLAGS) -DDP $< -o $@
diff --git a/liboctave/ChangeLog b/liboctave/ChangeLog
--- a/liboctave/ChangeLog
+++ b/liboctave/ChangeLog
@@ -1,8 +1,12 @@
+Sat Jan 25 22:36:21 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in (bin-dist): New target.
+
 Wed Jan 22 16:18:53 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* dbleSVD.cc (SVD::init): Work around apparent dgesvd() bug.
 	* CmplxSVD.cc (ComplexSVD::init): Work around apparent zgesvd() bug.
 
 Mon Jan 20 18:44:11 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* chMatrix.cc (charMatrix::charMatrix (const string&)):
diff --git a/liboctave/Makefile.in b/liboctave/Makefile.in
--- a/liboctave/Makefile.in
+++ b/liboctave/Makefile.in
@@ -72,16 +72,21 @@ SOURCES := Bounds.cc CollocWt.cc DAE.cc 
 	$(TI_SRC) \
 	$(MATRIX_SRC)
 
 EXTRAS := mx-inlines.cc
 
 DISTFILES := Makefile.in ChangeLog safe-xstat.cin safe-xstat.hin \
 	$(SOURCES) $(INCLUDES) $(EXTRAS)
 
+ifeq ($(SHARED_LIBS), true)
+  BINDISTFILES = liboctave.$(SHLEXT)
+  BINDISTLIBS = $(addprefix liboctave/, liboctave.$(SHLEXT))
+endif
+
 MAKEDEPS_1 := $(patsubst %.cc, %.d, $(SOURCES))
 MAKEDEPS := $(patsubst %.c, %.d, $(MAKEDEPS_1))
 
 OBJECTS_1 := $(patsubst %.cc, %.o, $(SOURCES))
 OBJECTS := $(patsubst %.c, %.o, $(OBJECTS_1))
 
 ifeq ($(SHARED_LIBS), true)
   ifdef CXXPICFLAG
@@ -95,17 +100,17 @@ LIBOCTAVE_DEPEND := $(patsubst %, liboct
 
 all: stamp-prereq stamp-picdir liboctave.a stamp-shared
 .PHONY: all
 
 stamp-prereq: safe-stat.h safe-lstat.h
 	touch stamp-prereq
 
 stamp-picdir:
-	if [ "$(SHARED_LIBS)" = true ]; then \
+	if $(SHARED_LIBS); then \
 	  if [ -n "$(CPICFLAG)" ] || [ -n "$(CXXPICFLAG)" ]; then \
 	    if [ -d pic ]; then \
 	      true ; \
 	    else \
 	      mkdir pic ; \
 	    fi ; \
 	  fi ; \
 	else \
@@ -217,16 +222,23 @@ maintainer-clean: distclean
 	rm -f tags TAGS stamp-picdir stamp-shared stamp-prereq
 	-rmdir pic
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../`cat ../.fname`/liboctave
 .PHONY: dist
 
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/liboctave ; \
+	fi
+	echo $(BINDISTLIBS) >> ../`cat ../.fname`/LIBRARIES
+.PHONY: bin-dist
+
 # If missing, GNU make attempts to create them in the reverse of the
 # order in which they are listed here.  We rely on that fact to ensure
 # that the safe-stat.h and safe-lstat.h files are created before trying
 # to create the .d files.  Hmm.  I wonder if we can count on that...
 
 ifndef omit_deps
 -include $(MAKEDEPS) stamp-prereq
 endif
diff --git a/octMakefile.in b/octMakefile.in
--- a/octMakefile.in
+++ b/octMakefile.in
@@ -20,40 +20,48 @@ INSTALL_DATA = @INSTALL_DATA@
 
 CONF_DISTFILES = Makefile.in octMakefile.in Makeconf.in configure \
 	configure.in config.guess config.sub aclocal.m4 config.h.in \
 	acconfig.h config.h.bot install-sh
 
 DISTFILES = $(CONF_DISTFILES) \
 	BUGS COPYING INSTALL INSTALL.OCTAVE NEWS NEWS.[0-9] PROJECTS \
 	README README.Linux README.NLP README.Windows ROADMAP \
-	SENDING-PATCHES THANKS move-if-change octave.sh octave-bug.in \
-	doinstall.sh mkinstalldirs mkoctfile.in texi2dvi INFO.PATCH \
+	SENDING-PATCHES THANKS move-if-change octave-sh octave-bug.in \
+	install-octave mkinstalldirs mkoctfile.in texi2dvi INFO.PATCH \
 	MAKEINFO.PATCH ChangeLog ChangeLog.[0-9]
 
 # Complete directory trees to distribute.
 DISTDIRS = emacs glob kpathsea make # plplot
 
 # Subdirectories in which to run `make all'.
 SUBDIRS = @INFO_DIR@ @PLPLOT_DIR@ @READLINE_DIR@ @DLFCN_DIR@ glob \
 	kpathsea libcruft liboctave src scripts doc examples
 
 # Subdirectories in which to run `make conf-dist'.
 CONF_DISTSUBDIRS = src
 
 # Subdirectories in which to run `make dist'.
 DISTSUBDIRS = libcruft liboctave info readline dlfcn src scripts \
 	test doc examples
 
-BINDISTFILES = COPYING ChangeLog NEWS README THANKS INSTALL.OCTAVE \
-	BUGS PROJECTS octave-bug octave.sh doinstall.sh \
-	mkinstalldirs
+XBINDISTFILES = BUGS COPYING INSTALL INSTALL.OCTAVE NEWS NEWS.[0-9] \
+	PROJECTS README README.Linux README.NLP README.Windows \
+	SENDING-PATCHES THANKS octave-sh insatll-octave mkinstalldirs \
+	ChangeLog ChangeLog.[0-9]
 
-# Subdirectories in which to run `make dist'.
-BINDISTSUBDIRS = emacs scripts doc
+BINDISTFILES = $(addprefix $(srcdir)/, $(XBINDISTFILES)) \
+	octave-bug VERSION ARCH
+
+# Subdirectories in which to run `make bin-dist'.
+BINDISTSUBDIRS = libcruft liboctave src info kpathsea readline \
+	scripts doc examples
+
+# Complete directories trees to distribute with binary distributions.
+BINDISTDIRS = emacs
 
 # Subdirectories in which to run clean targets.
 CLEANSUBDIRS = $(DISTSUBDIRS) glob kpathsea
 
 DIRS_TO_MAKE = $(bindir) $(libdir) $(octincludedir) $(fcnfiledir) \
   $(octfiledir) $(archlibdir) $(localarchlibdir) \
   `echo $(localfcnfilepath) | awk -F: '{for (i=1; i<=NF; i++) print $i}'` \
   `echo $(localoctfilepath) | awk -F: '{for (i=1; i<=NF; i++) print $i}'`
@@ -118,107 +126,91 @@ clean mostlyclean distclean maintainer-c
 	$(foreach d, $(CLEANSUBDIRS), $(do-subdir-for-command))
 .PHONY: clean mostlyclean distclean maintainer-clean
 
 maintainer-clean distclean::
 	rm -f octMakefile octave-bug Makefile Makeconf config.cache
 	rm -f config.h config.log config.status Makerules.f77
 	rm -f mk-oct-links mkoctfile
 
-# Now that things are under RCS control, we need to do the recursive
-# chmod so that the distributed files end up with reasonable modes.
-
-# Shared rules for making clean tar files.
-
-clean-tar:
-	echo octave-$(version) > .fname
-	tar xf `cat .fname`.tar
-	find `cat .fname` \( \( -name RCS -a -type d \) \
-	  -o \( -name OLD -a -type d \) -o -name "=*" \
-	  -o -name '*~' -o -name '#*#' -o -name config.log \
-	  -o -name config.status -o -name Makefile \
-	  -o -name c-auto.h \) -print | xargs rm -rf
-	rm -f `cat .fname`/test/octave.test/*.m
-	rm -rf `cat .fname`/test/octave.test/npsol
-	rm -rf `cat .fname`/test/octave.test/qpsol
-	chmod -R a+rwX `cat .fname`
-	tar cf `cat .fname`.tar `cat .fname`
-	rm -rf `cat .fname` .fname
-.PHONY: clean-tar
-
-dist-z:
-	echo octave-$(version) > .fname
-	rm -f `cat .fname`.tar.gz
-	gzip --best `cat .fname`.tar
-	rm -f .fname
-.PHONY: dist-z
-
 # Rules for making a source distribution.
 
-dist-info-files: octave.info INSTALL.OCTAVE BUGS kpathsea.info
+dist-info-files: INSTALL.OCTAVE BUGS
 .PHONY: dist-info-files
 
 links-for-dist: dist-info-files
 	echo octave-$(version) > .fname
 	rm -rf `cat .fname`
 	mkdir `cat .fname`
 	ln $(DISTFILES) `cat .fname`
 	for dir in $(DISTDIRS); do ln -s ../$$dir `cat .fname`; done
 	for dir in $(DISTSUBDIRS); do mkdir `cat .fname`/$$dir; cd $$dir; $(MAKE) dist; cd ..; done
 .PHONY: links-for-dist
 
 dist-tar: links-for-dist
 	tar chf `cat .fname`.tar `cat .fname`
 	rm -rf `cat .fname`
 .PHONY: dist-tar
 
-clean-dist-tar: dist-tar
-	$(MAKE) clean-tar
-.PHONY: clean-dist-tar
-
-dist: clean-dist-tar
+dist: dist-tar
+	echo octave-$(version) > .fname
+	tar xf `cat .fname`.tar
+	find `cat .fname` \( \( -name RCS -a -type d \) \
+	  -o \( -name OLD -a -type d \) -o -name "=*" \
+	  -o -name '*~' -o -name '#*#' -o -name config.log \
+	  -o -name config.status -o -name Makefile \
+	  -o -name c-auto.h \) -print | xargs rm -rf
+	rm -f `cat .fname`/test/octave.test/*.m
+	rm -rf `cat .fname`/test/octave.test/npsol
+	rm -rf `cat .fname`/test/octave.test/qpsol
+	chmod -R a+rwX `cat .fname`
+	tar cf `cat .fname`.tar `cat .fname`
+	rm -rf `cat .fname` .fname
 .PHONY: dist
 
 # Rules for making a binary distribution.
 
-links-for-bin-dist: dist-info-files
-	echo octave-$(version) > .fname
+VERSION:
+	echo $(version) > VERSION
+.PHONY: VERSION
+
+ARCH:
+	echo $(target_host_type) > ARCH
+.PHONY: ARCH
+
+links-for-bin-dist: VERSION ARCH octave-bug dist-info-files
+	echo octave-$(version)-$(target_host_type) > .fname
 	rm -rf `cat .fname`
 	mkdir `cat .fname`
 	ln $(BINDISTFILES) `cat .fname`
-	for dir in $(BINDISTSUBDIRS); do mkdir `cat .fname`/$$dir; cd $$dir; $(MAKE) dist; cd ..; done
-.PHONY: links-for-dist
+#	for dir in $(BINDISTDIRS); do ln -s ../$$dir `cat .fname`; done
+	for dir in $(BINDISTSUBDIRS); do mkdir `cat .fname`/$$dir; cd $$dir; $(MAKE) bin-dist; cd ..; done
+.PHONY: links-for-bin-dist
 
 bin-dist-tar: links-for-bin-dist
-	-strip src/octave
-	echo octave-$(version) > .fname
-	ln src/octave `cat .fname`/octave
+	echo octave-$(version)-$(target_host_type) > .fname
 	tar chf `cat .fname`.tar `cat .fname`
 	rm -rf `cat .fname`
 .PHONY: bin-dist-tar
 
-clean-bin-dist-tar: bin-dist-tar
-	$(MAKE) clean-tar
-.PHONY: clean-bin-dist-tar
-
-# binary-dist: clean-bin-dist-tar
-binary-dist:
-	@echo ""
-	@echo "**********************************************************"
-	@echo "*                                                        *"
-	@echo "* The binary-dist target doesn't work for this version   *"
-	@echo "* of Octave.                                             *"
-	@echo "*                                                        *"
-	@echo "* If you are interested in making a binary distribution  *"
-	@echo "* of this version of Octave, please contact              *"
-	@echo "* bug-octave@bevo.che.wisc.edu.                          *"
-	@echo "*                                                        *"
-	@echo "**********************************************************"
-	@echo ""
-.PHONY: binary-dist
+binary-dist bin-dist: bin-dist-tar
+	echo octave-$(version)-$(target_host_type) > .fname
+	tar xf `cat .fname`.tar
+	find `cat .fname` \( \( -name RCS -a -type d \) \
+	  -o \( -name OLD -a -type d \) -o -name "=*" \
+	  -o -name '*~' -o -name '#*#' -o -name config.log \
+	  -o -name config.status -o -name Makefile \
+	  -o -name c-auto.h \) -print | xargs rm -rf
+	rm -f `cat .fname`/test/octave.test/*.m
+	rm -rf `cat .fname`/test/octave.test/npsol
+	rm -rf `cat .fname`/test/octave.test/qpsol
+	chmod -R a+rwX `cat .fname`
+	tar cf `cat .fname`.tar `cat .fname`
+	rm -rf `cat .fname` .fname
+.PHONY: binary-dist bin-dist
 
 # Rules for making a dist of just the stuff needed to run configure.
 
 conf-dist:
 	echo config-dist-$(version) > .fname
 	rm -rf `cat .fname`
 	mkdir `cat .fname`
 	ln $(CONF_DISTFILES) `cat .fname`
diff --git a/readline/ChangeLog b/readline/ChangeLog
--- a/readline/ChangeLog
+++ b/readline/ChangeLog
@@ -1,8 +1,12 @@
+Sat Jan 25 22:36:28 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in (bin-dist): New target.
+
 Sat Jan 18 15:56:49 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* Makefile.in (stamp-readline): Put CC command on a single line.
 
 Mon Dec  9 13:13:59 1996  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* complete.c (username_completion_function) [__CYGWIN32__]:
 	Don't do anything.
diff --git a/readline/Makefile.in b/readline/Makefile.in
--- a/readline/Makefile.in
+++ b/readline/Makefile.in
@@ -107,16 +107,21 @@ ifeq ($(SHARED_LIBS), true)
     PICOBJ := $(OBJECTS)
     HIST_PICOBJ := $(HIST_OBJ)
   endif
 endif
 
 DISTFILES = $(CSOURCES) $(HSOURCES) Makefile.in configure.in \
 	configure README STANDALONE COPYING config.h.in
 
+ifeq ($(SHARED_LIBS), true)
+  BINDISTFILES = $(SH_LIBS_TO_INSTALL)
+  BINDISTLIBS = $(addprefix readline/, $(SH_LIBS_TO_INSTALL))
+endif
+
 SUBDIRS = doc examples
 
 # The texinfo files which document this library.
 DOCSOURCE = doc/rlman.texinfo doc/rltech.texinfo doc/rluser.texinfo
 DOCOBJECT = doc/readline.dvi
 DOCSUPPORT = doc/Makefile
 DOCUMENTATION = $(DOCSOURCE) $(DOCOBJECT) $(DOCSUPPORT)
 
@@ -218,16 +223,24 @@ maintainer-clean realclean distclean::
 	rm -f Makefile config.log config.status stamp-picdir
 	-rmdir pic
 
 dist:
 	for dir in $(SUBDIRS); do mkdir ../`cat ../.fname`/readline/$$dir; cd $$dir; $(MAKE) $@; cd ..; done
 	ln $(DISTFILES) ../`cat ../.fname`/readline
 .PHONY: dist
 
+
+bin-dist:
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/readline ; \
+	fi
+	echo $(BINDISTLIBS) >> ../`cat ../.fname`/LIBRARIES
+.PHONY: bin-dist
+
 # Dependencies
 readline.o: readline.c readline.h rldefs.h rlconf.h chardefs.h
 readline.o: keymaps.h history.h
 vi_mode.o:  rldefs.h rlconf.h readline.h history.h
 funmap.o:   funmap.c readline.h rlconf.h
 keymaps.o:  keymaps.c emacs_keymap.c vi_keymap.c keymaps.h chardefs.h rlconf.h
 history.o: history.h memalloc.h
 isearch.o: memalloc.h readline.h history.h
diff --git a/scripts/ChangeLog b/scripts/ChangeLog
--- a/scripts/ChangeLog
+++ b/scripts/ChangeLog
@@ -1,8 +1,19 @@
+Sat Jan 25 22:37:07 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in, audio/Makefile.in, control/Makefile.in,
+	elfun/Makefile.in, general/Makefile.in, image/Makefile.in,
+	io/Makefile.in, linear-algebra/Makefile.in,
+	miscellaneous/Makefile.in, plot/Makefile.in,
+	polynomial/Makefile.in, set/Makefile.in, signal/Makefile.in,
+	specfun/Makefile.in, special-matrix/Makefile.in,
+	startup/Makefile.in, statistics/Makefile.in, strings/Makefile.in,
+	time/Makefile.in (bin-dist): New target.
+
 Wed Jan 22 11:28:30 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* specfun/erfinv.m: Avoid A([]) = X, X != [] error.
 
 Tue Jan 21 11:16:40 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* miscellaneous/xor.m: Make it work.
 
diff --git a/scripts/Makefile.in b/scripts/Makefile.in
--- a/scripts/Makefile.in
+++ b/scripts/Makefile.in
@@ -26,16 +26,18 @@ DISTFILES = Makefile.in ChangeLog $(SOUR
 	configure mkinstalldirs
 
 SUBDIRS = audio control elfun general image io linear-algebra \
 	miscellaneous plot polynomial set signal specfun \
 	special-matrix startup statistics strings time
 
 DISTSUBDIRS = $(SUBDIRS)
 
+BINDISTSUBDIRS = $(SUBDIRS)
+
 FCN_FILES = # $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = # $(notdir $(FCN_FILES))
 
 all: $(SUBDIRS)
 .PHONY: all
 
 $(SUBDIRS):
 	echo making all in $@
@@ -63,11 +65,15 @@ TAGS:: $(SOURCES)
 
 distclean::
 	rm -f Makefile config.log config.status
 
 maintainer-clean::
 	rm -f tags TAGS Makefile config.log config.status
 
 dist:
-	ln $(DISTFILES) ../`cat ../.fname`/scripts
+	$(LN_S) $(DISTFILES) ../`cat ../.fname`/scripts
 	for dir in $(DISTSUBDIRS); do mkdir ../`cat ../.fname`/scripts/$$dir; cd $$dir; $(MAKE) $@; cd ..; done
 .PHONY: dist
+
+bin-dist:
+	for dir in $(BINDISTSUBDIRS); do mkdir ../`cat ../.fname`/scripts/$$dir; cd $$dir; $(MAKE) $@; cd ..; done
+.PHONY: bin-dist
diff --git a/scripts/audio/Makefile.in b/scripts/audio/Makefile.in
--- a/scripts/audio/Makefile.in
+++ b/scripts/audio/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/audio
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/audio
+.PHONY: bin-dist
diff --git a/scripts/control/Makefile.in b/scripts/control/Makefile.in
--- a/scripts/control/Makefile.in
+++ b/scripts/control/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/control
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/control
+.PHONY: bin-dist
diff --git a/scripts/elfun/Makefile.in b/scripts/elfun/Makefile.in
--- a/scripts/elfun/Makefile.in
+++ b/scripts/elfun/Makefile.in
@@ -1,9 +1,9 @@
-#
+
 # Makefile for octave's scripts/elfun directory
 #
 # John W. Eaton
 # jwe@bevo.che.wisc.edu
 # University of Wisconsin-Madison
 # Department of Chemical Engineering
 
 TOPDIR = ../..
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/elfun
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/elfun
+.PHONY: bin-dist
diff --git a/scripts/general/Makefile.in b/scripts/general/Makefile.in
--- a/scripts/general/Makefile.in
+++ b/scripts/general/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/general
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/general
+.PHONY: bin-dist
diff --git a/scripts/image/Makefile.in b/scripts/image/Makefile.in
--- a/scripts/image/Makefile.in
+++ b/scripts/image/Makefile.in
@@ -26,16 +26,18 @@ IMAGES = *.img
 DISTFILES = Makefile.in $(SOURCES) $(IMAGES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
 IMAGE_FILES = $(wildcard $(srcdir)/*.img)
 IMAGE_FILES_NO_DIR = $(notdir $(IMAGE_FILES))
 
+BINDISTFILES = $(FCN_FILES) $(IMAGE_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -75,8 +77,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/image
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/image
+.PHONY: bin-dist
diff --git a/scripts/io/Makefile.in b/scripts/io/Makefile.in
--- a/scripts/io/Makefile.in
+++ b/scripts/io/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/io
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/io
+.PHONY: bin-dist
diff --git a/scripts/linear-algebra/Makefile.in b/scripts/linear-algebra/Makefile.in
--- a/scripts/linear-algebra/Makefile.in
+++ b/scripts/linear-algebra/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/linear-algebra
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/linear-algebra
+.PHONY: bin-dist
diff --git a/scripts/miscellaneous/Makefile.in b/scripts/miscellaneous/Makefile.in
--- a/scripts/miscellaneous/Makefile.in
+++ b/scripts/miscellaneous/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/miscellaneous
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/miscellaneous
+.PHONY: bin-dist
diff --git a/scripts/plot/Makefile.in b/scripts/plot/Makefile.in
--- a/scripts/plot/Makefile.in
+++ b/scripts/plot/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/plot
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/plot
+.PHONY: bin-dist
diff --git a/scripts/polynomial/Makefile.in b/scripts/polynomial/Makefile.in
--- a/scripts/polynomial/Makefile.in
+++ b/scripts/polynomial/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/polynomial
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/polynomial
+.PHONY: bin-dist
diff --git a/scripts/set/Makefile.in b/scripts/set/Makefile.in
--- a/scripts/set/Makefile.in
+++ b/scripts/set/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/set
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/set
+.PHONY: bin-dist
diff --git a/scripts/signal/Makefile.in b/scripts/signal/Makefile.in
--- a/scripts/signal/Makefile.in
+++ b/scripts/signal/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/signal
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/signal
+.PHONY: bin-dist
diff --git a/scripts/specfun/Makefile.in b/scripts/specfun/Makefile.in
--- a/scripts/specfun/Makefile.in
+++ b/scripts/specfun/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/specfun
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/specfun
+.PHONY: bin-dist
diff --git a/scripts/special-matrix/Makefile.in b/scripts/special-matrix/Makefile.in
--- a/scripts/special-matrix/Makefile.in
+++ b/scripts/special-matrix/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/special-matrix
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/special-matrix
+.PHONY: bin-dist
diff --git a/scripts/startup/Makefile.in b/scripts/startup/Makefile.in
--- a/scripts/startup/Makefile.in
+++ b/scripts/startup/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = octaverc # *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = # $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = # $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(srcdir)/octaverc
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	if test -f $(fcnfiledir)/$(script_sub_dir)/octaverc ; then true ; \
 	else \
 	  $(INSTALL_DATA) $(srcdir)/octaverc \
@@ -74,8 +76,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/startup
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/startup
+.PHONY: bin-dist
diff --git a/scripts/statistics/Makefile.in b/scripts/statistics/Makefile.in
--- a/scripts/statistics/Makefile.in
+++ b/scripts/statistics/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/statistics
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/statistics
+.PHONY: bin-dist
diff --git a/scripts/strings/Makefile.in b/scripts/strings/Makefile.in
--- a/scripts/strings/Makefile.in
+++ b/scripts/strings/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/strings
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/strings
+.PHONY: bin-dist
diff --git a/scripts/time/Makefile.in b/scripts/time/Makefile.in
--- a/scripts/time/Makefile.in
+++ b/scripts/time/Makefile.in
@@ -22,16 +22,18 @@ INSTALL_DATA = @INSTALL_DATA@
 
 SOURCES = *.m
 
 DISTFILES = Makefile.in $(SOURCES)
 
 FCN_FILES = $(wildcard $(srcdir)/*.m)
 FCN_FILES_NO_DIR = $(notdir $(FCN_FILES))
 
+BINDISTFILES = $(FCN_FILES)
+
 all:
 .PHONY: all
 
 install:
 	$(top_srcdir)/mkinstalldirs $(fcnfiledir)/$(script_sub_dir)
 	for f in $(FCN_FILES_NO_DIR) ; do \
 	  rm -f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
 	  $(INSTALL_DATA) $(srcdir)/$$f $(fcnfiledir)/$(script_sub_dir)/$$f ; \
@@ -62,8 +64,12 @@ distclean: clean
 
 maintainer-clean: distclean
 	rm -f tags TAGS
 .PHONY: maintainer-clean
 
 dist:
 	ln $(DISTFILES) ../../`cat ../../.fname`/scripts/time
 .PHONY: dist
+
+bin-dist:
+	ln $(BINDISTFILES) ../../`cat ../../.fname`/scripts/time
+.PHONY: bin-dist
diff --git a/src/ChangeLog b/src/ChangeLog
--- a/src/ChangeLog
+++ b/src/ChangeLog
@@ -1,8 +1,12 @@
+Sat Jan 25 22:36:39 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
+
+	* Makefile.in (bin-dist): Update for 2.x.
+
 Fri Jan 24 10:05:00 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
 
 	* mk-oct-links.in: New arg, -p, to just print list of files to link.
 
 	* lex.l (handle_number): Convert `D' or `d' exponents to `e'
 	before scanning.
 
 Thu Jan 23 10:00:00 1997  John W. Eaton  <jwe@bevo.che.wisc.edu>
diff --git a/src/Makefile.in b/src/Makefile.in
--- a/src/Makefile.in
+++ b/src/Makefile.in
@@ -165,18 +165,24 @@ SH_LIBS_TO_INSTALL = liboctinterp.$(SHLE
 
 LIBS = @LIBS@
 
 DISTFILES = Makefile.in ChangeLog mkdefs mkbuiltins mk-oct-links.in \
 	defaults.h.in oct-conf.h.in octave.gperf oct-gperf.h \
 	octave.cc parse.cc lex.cc y.tab.h \
 	$(INCLUDES) $(DLD_SRC) $(SOURCES) $(TI_SRC)
 
-all: stamp-prereq stamp-picdir libraries \
-	$(OCT_FILES) octave
+ifeq ($(SHARED_LIBS), true)
+  BINDISTFILES = octave $(OCT_FILES) $(SH_LIBS_TO_INSTALL)
+  BINDISTLIBS = $(addprefix src/, $(SH_LIBS_TO_INSTALL))
+else
+  BINDISTFILES = octave $(OCT_FILES)
+endif
+
+all: stamp-prereq stamp-picdir libraries $(OCT_FILES) octave
 .PHONY: all
 
 stamp-prereq: defaults.h oct-conf.h
 	touch stamp-prereq
 
 octave: octave.o builtins.o $(DLD_STATIC_OBJ) libraries
 	$(CXX) $(CPPFLAGS) $(ALL_CXXFLAGS) $(ALL_LDFLAGS) -o octave \
 	octave.o builtins.o $(DLD_STATIC_OBJ) \
@@ -244,28 +250,28 @@ check: all
 
 install: install-bin install-oct install-lib install-inc
 .PHONY: install
 
 mk-oct-links: mk-oct-links.in
 	sed < $< > $@.tmp \
 	  -e "s;%LN_S%;${LN_S};"
 	$(top_srcdir)/move-if-change $@.tmp $@
+	chmod a+rx mk-oct-links
 
 install-bin:
 	$(top_srcdir)/mkinstalldirs $(bindir)
 	rm -f $(bindir)/octave
 	$(INSTALL_PROGRAM) octave$(EXE) $(bindir)/octave-$(version)$(EXE)
 	$(LN_S) $(bindir)/octave-$(version)$(EXE) $(bindir)/octave$(EXE)
 .PHONY: install-bin
 
 install-oct: mk-oct-links
 	if [ -n "$(OCT_FILES)" ]; then \
 	  $(top_srcdir)/mkinstalldirs $(octfiledir) ; \
-	  chmod a+rx mk-oct-links ; \
 	  xfiles="$(OCT_FILES)" ; \
 	  for f in $$xfiles ; do \
 	    $(INSTALL_PROGRAM) $$f $(octfiledir)/$$f; \
 	  done ; \
 	  ./mk-oct-links $(octfiledir) $(addprefix $(srcdir)/, $(DLD_SRC)) ; \
 	fi
 .PHONY: install-oct
 
@@ -338,16 +344,28 @@ dist: parse.cc lex.cc oct-gperf.h
 	rm -f parse.cc lex.cc y.tab.h y.output yy.lex.c
 	rm -f oct-gperf.h defaults.h oct-conf.h *.d *.df builtins.cc
 .PHONY: dist
 
 conf-dist:
 	ln octave.cc Makefile.in ../`cat ../.fname`/src
 .PHONY: conf-dist
 
+bin-dist: mk-oct-links
+	if [ -n "$(BINDISTFILES)" ]; then \
+	  ln $(BINDISTFILES) ../`cat ../.fname`/src ; \
+	fi
+	if [ -n "$(OCT_FILES)" ]; then \
+	  ./mk-oct-links -p $(octfiledir) \
+	    $(addprefix $(srcdir)/, $(DLD_SRC)) \
+	    > ../`cat ../.fname`/src/links-to-make ; \
+	fi
+	echo $(BINDISTLIBS) >> ../`cat ../.fname`/LIBRARIES
+.PHONY: bin-dist
+
 # Special rules -- these files need special things to be defined.
 
 parse.cc : parse.y
 	@echo "expect 13 shift/reduce conflicts"
 	$(YACC) $(YFLAGS) $<
 	@$(top_srcdir)/move-if-change y.tab.c $(@F)
 
 lex.cc : lex.l
