# HG changeset patch
# User Rik <rik@octave.org>
# Date 1426101578 25200
#      Wed Mar 11 12:19:38 2015 -0700
# Node ID e884d58164713ba5de3cd9389b495c6c970a9d3a
# Parent  0cc365dada52bb499de2127657f3776a52b5aec2
Remove extra newlines at end of help printout (bug #44504).

* __makeinfo__.m: Remove "\n\n" footer generated by makeinfo when producing
"plain text" output.

diff --git a/scripts/help/__makeinfo__.m b/scripts/help/__makeinfo__.m
--- a/scripts/help/__makeinfo__.m
+++ b/scripts/help/__makeinfo__.m
@@ -136,16 +136,23 @@ function [retval, status] = __makeinfo__
                        makeinfo_program (), name);
       otherwise
         error ("__makeinfo__: unsupported output type: '%s'", output_type);
     endswitch
 
     ## Call makeinfo
     [status, retval] = system (cmd);
 
+    ## Clean up extra newlines generated by makeinfo
+    if (strcmpi (output_type, "plain text"))
+      if (numel (retval) > 2 && retval(end-1:end) == "\n\n")
+        retval = retval(1:end-2);
+      endif
+    endif
+
   unwind_protect_cleanup
     if (exist (name, "file"))
       delete (name);
     endif
   end_unwind_protect
 endfunction
 
 
