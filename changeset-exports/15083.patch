# HG changeset patch
# User Rik <rik@octave.org>
# Date 1343950195 25200
#      Thu Aug 02 16:29:55 2012 -0700
# Node ID 83749bb7f538db17b34cf47d6e8e7bfd505ce12b
# Parent  902a8e27b2a28c2c0b4455bfce7f847b626d1a24
maint: Move autogenerated option functions to corefcn/ directory.

* src/Makefile.am: Remove rules for building OPT_HANDLERS, OPT_INC.

* src/corefcn/module.mk: Add rules for building OPT_HANDLERS, OPT_INC.

diff --git a/src/Makefile.am b/src/Makefile.am
--- a/src/Makefile.am
+++ b/src/Makefile.am
@@ -117,29 +117,29 @@ EXTRA_DIST = \
   oct-conf.in.h \
   oct-errno.in.cc \
   octave-config.in.cc \
   octave-config.in.sh \
   octave.gperf \
   version.in.h \
   $(BUILT_DISTFILES)
 
-OPT_HANDLERS = \
-  DASPK-opts.cc \
-  DASRT-opts.cc \
-  DASSL-opts.cc \
-  LSODE-opts.cc \
-  Quad-opts.cc
-
-OPT_INC = \
-  ../liboctave/DASPK-opts.h \
-  ../liboctave/DASRT-opts.h \
-  ../liboctave/DASSL-opts.h \
-  ../liboctave/LSODE-opts.h \
-  ../liboctave/Quad-opts.h
+#OPT_HANDLERS = \
+#  DASPK-opts.cc \
+#  DASRT-opts.cc \
+#  DASSL-opts.cc \
+#  LSODE-opts.cc \
+#  Quad-opts.cc
+#
+#OPT_INC = \
+#  ../liboctave/DASPK-opts.h \
+#  ../liboctave/DASRT-opts.h \
+#  ../liboctave/DASSL-opts.h \
+#  ../liboctave/LSODE-opts.h \
+#  ../liboctave/Quad-opts.h
 
 JIT_INCLUDES = \
   jit-util.h \
   jit-typeinfo.h \
   jit-ir.h \
   pt-jit.h
 
 octinclude_HEADERS = \
@@ -470,22 +470,22 @@ oct-errno.cc: oct-errno.in.cc Makefile
 	  $(srcdir)/mk-errno-list --perl "$(PERL)" < $< > $@-t; \
 	elif test -n "$(PYTHON)"; then \
 	  $(srcdir)/mk-errno-list --python "$(PYTHON)" < $< > $@-t; \
 	else \
 	  $(SED) '/@SYSDEP_ERRNO_LIST@/D' $< > $@-t; \
 	fi
 	mv $@-t $@
 
-$(OPT_HANDLERS) : %.cc : $(top_srcdir)/liboctave/%.in $(top_srcdir)/build-aux/mk-opts.pl
-	$(PERL) $(top_srcdir)/build-aux/mk-opts.pl --opt-handler-fcns $< > $@-t
-	mv $@-t $@
-
-$(OPT_INC) : %.h : %.in
-	$(MAKE) -C $(@D) $(@F)
+#$(OPT_HANDLERS) : %.cc : $(top_srcdir)/liboctave/%.in $(top_srcdir)/build-aux/mk-opts.pl
+#	$(PERL) $(top_srcdir)/build-aux/mk-opts.pl --opt-handler-fcns $< > $@-t
+#	mv $@-t $@
+#
+#$(OPT_INC) : %.h : %.in
+#	$(MAKE) -C $(@D) $(@F)
 
 if AMCOND_ENABLE_DYNAMIC_LINKING
 DLDFCN_PKG_ADD_FILE = dldfcn/PKG_ADD
 
 dldfcn/PKG_ADD: $(DLDFCN_DEF_FILES) mk-pkg-add
 	$(srcdir)/mk-pkg-add $(DLDFCN_DEF_FILES) > $@-t
 	mv $@-t $@
 endif
diff --git a/src/corefcn/module.mk b/src/corefcn/module.mk
--- a/src/corefcn/module.mk
+++ b/src/corefcn/module.mk
@@ -1,11 +1,34 @@
 EXTRA_DIST += \
   corefcn/module.mk
 
+## Options functions for Fortran packages like LSODE, DASPK.
+## These are generated automagically by configure and Perl.
+OPT_HANDLERS = \
+  corefcn/DASPK-opts.cc \
+  corefcn/DASRT-opts.cc \
+  corefcn/DASSL-opts.cc \
+  corefcn/LSODE-opts.cc \
+  corefcn/Quad-opts.cc
+
+OPT_INC = \
+  $(top_builddir)/liboctave/DASPK-opts.h \
+  $(top_builddir)/liboctave/DASRT-opts.h \
+  $(top_builddir)/liboctave/DASSL-opts.h \
+  $(top_builddir)/liboctave/LSODE-opts.h \
+  $(top_builddir)/liboctave/Quad-opts.h
+
+$(OPT_HANDLERS): corefcn/%.cc : $(top_builddir)/liboctave/%.in
+	$(PERL) $(top_srcdir)/build-aux/mk-opts.pl --opt-handler-fcns $< > $@-t
+	mv $@-t $@
+
+$(OPT_INC) : %.h : %.in
+	$(MAKE) -C $(top_builddir)/liboctave $(@F)
+
 COREFCN_SRC = \
   corefcn/__contourc__.cc \
   corefcn/__dispatch__.cc \
   corefcn/__lin_interpn__.cc \
   corefcn/__pchip_deriv__.cc \
   corefcn/__qp__.cc \
   corefcn/balance.cc \
   corefcn/besselj.cc \
