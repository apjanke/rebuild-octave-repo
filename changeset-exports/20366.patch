# HG changeset patch
# User John W. Eaton <jwe@octave.org>
# Date 1437158687 14400
#      Fri Jul 17 14:44:47 2015 -0400
# Node ID 9b44691a3520237498d6e974c9cce8b7d19c26f4
# Parent  0932426e3866e35836cf51cc5ee444b6ac2b9117
provide per-directory clean targets

* Makefile.am, doc/module.mk, libgui/graphics/module.mk,
libgui/module.mk, libgui/qterminal-module.mk, libgui/src/module.mk,
libinterp/corefcn/module.mk, libinterp/module.mk,
libinterp/octave-value/module.mk, libinterp/operators/module.mk,
libinterp/parse-tree/module.mk, libinterp/template-inst/module.mk,
liboctave/array/module.mk, liboctave/cruft/Faddeeva/module.mk,
liboctave/cruft/amos/module.mk, liboctave/cruft/blas-xtra/module.mk,
liboctave/cruft/daspk/module.mk, liboctave/cruft/dasrt/module.mk,
liboctave/cruft/dassl/module.mk, liboctave/cruft/fftpack/module.mk,
liboctave/cruft/lapack-xtra/module.mk, liboctave/cruft/misc/module.mk,
liboctave/cruft/module.mk, liboctave/cruft/odepack/module.mk,
liboctave/cruft/ordered-qz/module.mk,
liboctave/cruft/quadpack/module.mk, liboctave/cruft/ranlib/module.mk,
liboctave/cruft/slatec-err/module.mk,
liboctave/cruft/slatec-fn/module.mk, liboctave/module.mk,
liboctave/numeric/module.mk, liboctave/operators/module.mk,
liboctave/system/module.mk, liboctave/util/module.mk,
scripts/java/module.mk, scripts/module.mk, scripts/startup/module.mk,
src/module.mk: For each major subdirectory tree (liboctave, libinterp,
libgui, src, doc, examples, test), provide SUBDIR-clean,
SUBDIR-distclean, and SUBDIR-maintainer-clean targets.

diff --git a/Makefile.am b/Makefile.am
--- a/Makefile.am
+++ b/Makefile.am
@@ -232,12 +232,12 @@ DIRS_TO_MAKE = \
 
 installdirs-local:
 	$(MKDIR_P) $(addprefix $(DESTDIR), $(DIRS_TO_MAKE))
 
 install-data-local: installdirs-local
 
 clean-local: doc-clean
 
-distclean-local: scripts-distclean
+distclean-local:
 
 maintainer-clean-local: doc-maintainer-clean
 
diff --git a/doc/module.mk b/doc/module.mk
--- a/doc/module.mk
+++ b/doc/module.mk
@@ -1,8 +1,14 @@
+doc_EXTRA_DIST =
+
+doc_CLEANFILES =
+doc_DISTCLEANFILES =
+doc_MAINTAINERCLEANFILES =
+
 TEXINFO_TEX = doc/texinfo.tex
 
 TEXINPUTS := $(PATH_SEPARATOR)$(top_srcdir)/doc/interpreter$(PATH_SEPARATOR)$(PATH_SEPARATOR)$(top_builddir)/doc/interpreter$(PATH_SEPARATOR)$(TEXINPUTS)$(PATH_SEPARATOR)
 
 TEXMFCNF := $(PATH_SEPARATOR)$(top_srcdir)/doc$(PATH_SEPARATOR)$(top_builddir)/doc$(PATH_SEPARATOR)$(TEXMFCNF)$(PATH_SEPARATOR)
 
 export TEXINPUTS
 export TEXMFCNF
@@ -23,21 +29,21 @@ am__v_PDFTEX_1 =
 
 if AMCOND_BUILD_DOCS
 
 ## Listing "dvi" explicitly here seems to cause two simultaneous
 ## builds of the DVI files, presumably because the PS version
 ## also depends on the DVI file and somehow the rules are invoked
 ## twice.  Is that a bug in automake or make or what?
 
-EXTRA_DIST += \
+doc_EXTRA_DIST += \
   doc/texinfo.tex \
   doc/texmf.cnf
 
-EXTRA_DIST += \
+doc_EXTRA_DIST += \
   doc/doxyhtml/Doxyfile.in \
   doc/doxyhtml/README
 
 doxyhtml: doc/doxyhtml/$(octave_dirstamp)
 	doxygen doc/doxyhtml/Doxyfile
 
 doxyhtml-maintainer-clean:
 	rm -f doc/doxygen_sqlite3.db
@@ -273,17 +279,17 @@ doc/interpreter/octave.pdf: doc/interpre
 DOC_TARGETS += \
   $(srcdir)/doc/interpreter/octave.info \
   doc/interpreter/doc-cache \
   doc/interpreter/octave.ps \
   doc/interpreter/octave.pdf \
   $(OCTAVE_HTML_STAMP) \
   $(HTMLDIR_IMAGES)
 
-EXTRA_DIST += \
+doc_EXTRA_DIST += \
   $(BUILT_OCTAVE_TEXI_SRC) \
   $(srcdir)/doc/interpreter/octave.info \
   doc/interpreter/TODO \
   doc/interpreter/doc-cache \
   doc/interpreter/octave.dvi \
   doc/interpreter/octave.ps \
   doc/interpreter/octave.pdf \
   doc/interpreter/octave.html \
@@ -344,17 +350,17 @@ BUGS: doc/interpreter/bugs.texi doc/inte
 	mv $@-t $@
 
 INSTALL.OCTAVE: doc/interpreter/install.texi doc/interpreter/$(octave_dirstamp)
 	$(AM_V_MAKEINFO)rm -f $@-t $@ && \
 	$(MAKEINFO) -D INSTALLONLY -I $(srcdir)/doc/interpreter \
 	  --no-validate --no-headers --no-split --output $@-t $< && \
 	mv $@-t $@
 
-EXTRA_DIST += \
+doc_EXTRA_DIST += \
   doc/interpreter/config-images.sh \
   doc/interpreter/contributors.in \
   doc/interpreter/doc-cache \
   doc/interpreter/find-docstring-files.sh \
   doc/interpreter/genpropdoc.m \
   doc/interpreter/graphics_properties.mk \
   doc/interpreter/images \
   doc/interpreter/images.awk \
@@ -363,27 +369,24 @@ EXTRA_DIST += \
   doc/interpreter/mk_doc_cache.m \
   doc/interpreter/mkcontrib.awk \
   doc/interpreter/munge-texi.pl \
   $(DOC_IMAGES) \
   $(DOC_IMAGES_SRC) \
   $(LOGOS) \
   $(TXI_SRC)
 
-interpreter-clean:
+doc-interpreter-clean:
 	rm -rf t2d_cache
 
-interpreter-maintainer-clean:
-	rm -f $(BUILT_OCTAVE_TEXI_SRC)
-
-DISTCLEANFILES += \
-  $(BUILT_TEXINFOS) \
+doc_DISTCLEANFILES += \
+  $(BUILT_OCTAVE_TEXI_SRC) \
   $(OCTAVE_HTML_STAMP)
 
-MAINTAINERCLEANFILES += \
+doc_MAINTAINERCLEANFILES += \
   AUTHORS \
   $(BUILT_DOC_IMAGES) \
   doc/interpreter/doc-cache
 
 DIRSTAMP_FILES += doc/interpreter/$(octave_dirstamp)
 
 liboctave_TEXINFOS = \
   doc/liboctave/array.texi \
@@ -410,30 +413,30 @@ info_TEXINFOS += \
   doc/liboctave/liboctave.texi
 
 DOC_TARGETS += \
   $(srcdir)/doc/liboctave/liboctave.info \
   doc/liboctave/liboctave.ps \
   doc/liboctave/liboctave.pdf \
   doc/liboctave/liboctave.html
 
-EXTRA_DIST += \
+doc_EXTRA_DIST += \
   $(liboctave_TEXINFOS) \
   $(srcdir)/doc/liboctave/liboctave.info \
   doc/liboctave/liboctave.dvi \
   doc/liboctave/liboctave.ps \
   doc/liboctave/liboctave.pdf \
   doc/liboctave/liboctave.html
 
 ## The texi2dvi script (used to create both PDF and DVI output formats)
 ## uses some fixed temporary file names.  In order to avoid a race condition
 ## the DVI and PDF builds are forced to run serially through a Makefile rule.
 #doc/liboctave/liboctave.pdf: doc/liboctave/liboctave.dvi
 
-liboctave-clean:
+doc-liboctave-clean:
 	rm -rf doc/liboctave/t2d_cache
 
 DIRSTAMP_FILES += doc/liboctave/$(octave_dirstamp)
 
 refcard_TEX_SRC = \
   doc/refcard/refcard.tex \
   doc/refcard/refcard-a4.tex \
   doc/refcard/refcard-legal.tex \
@@ -472,47 +475,43 @@ doc/refcard/refcard-legal.dvi: doc/refca
 doc/refcard/refcard-legal.ps: doc/refcard/refcard-legal.dvi
 	-$(AM_V_DVIPS)$(DVIPS) $(AM_V_texinfo) -T 14in,8.5in -o $@ $<
 
 doc/refcard/refcard-letter.pdf: doc/refcard/refcard.tex
 doc/refcard/refcard-letter.dvi: doc/refcard/refcard.tex
 doc/refcard/refcard-letter.ps: doc/refcard/refcard-letter.dvi
 	-$(AM_V_DVIPS)$(DVIPS) $(AM_V_texinfo) -T 11in,8.5in -o $@ $<
 
-EXTRA_DIST += \
-  $(refcard_FORMATTED) \
-  $(refcard_TEX_SRC)
-
-CLEANFILES += \
-  doc/refcard/refcard-a4.log \
-  doc/refcard/refcard-legal.log \
-  doc/refcard/refcard-letter.log
-
-MAINTAINERCLEANFILES += \
-  $(refcard_FORMATTED)
-
 DIRSTAMP_FILES += doc/refcard/$(octave_dirstamp)
 
-doc-clean: interpreter-clean
-
-doc-maintainer-clean: doxyhtml-maintainer-clean interpreter-maintainer-clean
-
 $(srcdir)/doc/interpreter/images.mk: $(srcdir)/doc/interpreter/config-images.sh $(srcdir)/doc/interpreter/images.awk $(srcdir)/doc/interpreter/images
 	$(srcdir)/doc/interpreter/config-images.sh $(top_srcdir)
 
 $(refcard_DVI) : %.dvi : %.tex doc/refcard/$(octave_dirstamp)
 	-$(AM_V_TEX)cd $(@D) && \
 	TEXINPUTS="$(abs_top_srcdir)/doc/refcard:$(TEXINPUTS):" \
 	$(TEX) $(<F) $(AM_V_texidevnull)
 
 $(refcard_PDF) : %.pdf : %.tex doc/refcard/$(octave_dirstamp)
 	-$(AM_V_PDFTEX)cd $(@D) && \
 	TEXINPUTS="$(abs_top_srcdir)/doc/refcard:$(TEXINPUTS):" \
 	$(PDFTEX) $(<F) $(AM_V_texidevnull)
 
+doc_EXTRA_DIST += \
+  $(refcard_FORMATTED) \
+  $(refcard_TEX_SRC)
+
+doc_CLEANFILES += \
+  doc/refcard/refcard-a4.log \
+  doc/refcard/refcard-legal.log \
+  doc/refcard/refcard-letter.log
+
+doc_MAINTAINERCLEANFILES += \
+  $(refcard_FORMATTED)
+
 endif
 
 doc/interpreter/undocumented_list:
 	rm -f $@-t $@
 	-$(PERL) $(srcdir)/doccheck/mk_undocumented_list > $@-t
 	mv $@-t $@
 .PHONY: doc/interpreter/undocumented_list
 
@@ -528,8 +527,23 @@ spellcheck: $(SPELLCHECK_FILES)
 		echo "Spellcheck failed"; \
 		echo "Review the following files:"; \
 		ls *.scheck ; \
 		exit 1 ; \
 	else \
 		echo "Spellcheck passed"; \
 	fi
 .PHONY: spellcheck
+
+EXTRA_DIST += $(doc_EXTRA_DIST)
+
+CLEANFILES += $(doc_CLEANFILES)
+DISTCLEANFILES += $(doc_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(doc_MAINTAINERCLEANFILES)
+
+doc-clean:
+	rm -f $(doc_CLEANFILES)
+
+doc-distclean: doc-clean
+	rm -f $(doc_DISTCLEANFILES)
+
+doc-maintainer-clean: doc-distclean
+	rm -f $(doc_MAINTAINERCLEANFILES)
diff --git a/etc/module.mk b/etc/module.mk
--- a/etc/module.mk
+++ b/etc/module.mk
@@ -1,23 +1,29 @@
-EXTRA_DIST += \
+etc_EXTRA_DIST =
+
+etc_CLEANFILES =
+etc_DISTCLEANFILES =
+etc_MAINTAINERCLEANFILES =
+
+etc_EXTRA_DIST += \
   etc/NEWS.1 \
   etc/NEWS.2 \
   etc/NEWS.3 \
   etc/PROJECTS \
   etc/README.Cygwin \
   etc/README.Linux \
   etc/README.MacOS \
   etc/README.MinGW \
   etc/README.Windows \
   etc/README.gnuplot \
   etc/README.kpathsea \
   etc/gdbinit
 
-EXTRA_DIST += \
+etc_EXTRA_DIST += \
   etc/OLD-ChangeLogs/ChangeLog \
   etc/OLD-ChangeLogs/ChangeLog.1 \
   etc/OLD-ChangeLogs/doc-ChangeLog \
   etc/OLD-ChangeLogs/libcruft-ChangeLog \
   etc/OLD-ChangeLogs/liboctave-ChangeLog \
   etc/OLD-ChangeLogs/scripts-ChangeLog \
   etc/OLD-ChangeLogs/src-ChangeLog \
   etc/OLD-ChangeLogs/test-ChangeLog
@@ -40,17 +46,17 @@ icon_PNG_SIZES = \
 BUILT_PNG_ICONS = $(patsubst %,etc/icons/octave-logo-%.png,$(icon_PNG_SIZES))
 
 WINDOWS_PNG_ICONS = $(filter %-16.png %-32.png %-48.png %-256.png,$(BUILT_PNG_ICONS))
 
 BUILT_ICONS = \
   $(BUILT_PNG_ICONS) \
   etc/icons/octave-logo.ico
 
-EXTRA_DIST += \
+etc_EXTRA_DIST += \
   $(BUILT_ICONS) \
   $(icon_IMAGE_FILES) \
   etc/icons/octave.appdata.xml.in \
   etc/icons/octave.desktop.in
 
 image_DATA += \
   $(icon_IMAGE_FILES) \
   etc/icons/octave-logo.ico
@@ -113,15 +119,29 @@ uninstall-icons:
 	fi
 	for f in $(BUILT_PNG_ICONS); do \
 	  size=`echo $$f | $(SED) -n -e "s/.*-\([0-9]\+\)\.png/\1/p"`; \
 	  rm -f $(DESTDIR)$(datadir)/icons/hicolor/$${size}x$${size}/apps/octave.png; \
 	done
 	rm -f $(DESTDIR)$(datadir)/icons/hicolor/scalable/apps/octave.svg
 	rm -f $(DESTDIR)$(datadir)/appdata/$(VENDOR)-octave.appdata.xml
 
-CLEANFILES += \
+EXTRA_DIST += $(etc_EXTRA_DIST)
+
+etc_CLEANFILES += \
   etc/icons/octave.appdata.xml \
   etc/icons/octave.desktop
 
-MAINTAINERCLEANFILES += \
+etc_MAINTAINERCLEANFILES += \
   $(BUILT_ICONS)
 
+CLEANFILES += $(etc_CLEANFILES)
+DISTCLEANFILES += $(etc_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(etc_MAINTAINERCLEANFILES)
+
+etc-clean:
+	rm -f $(etc_CLEANFILES)
+
+etc-distclean: etc-clean
+	rm -f $(etc_DISTCLEANFILES)
+
+etc-maintainer-clean: etc-distclean
+	rm -f $(etc_MAINTAINERCLEANFILES)
diff --git a/examples/module.mk b/examples/module.mk
--- a/examples/module.mk
+++ b/examples/module.mk
@@ -1,8 +1,14 @@
+examples_EXTRA_DIST =
+
+examples_CLEANFILES =
+examples_DISTCLEANFILES =
+examples_MAINTAINERCLEANFILES =
+
 examples_data_SRC = \
    examples/data/penny.mat
 
 octdata_DATA += \
   $(examples_data_SRC)
 
 examples_code_SRC = \
   examples/code/@FIRfilter/FIRfilter.m \
@@ -50,13 +56,28 @@ examples_code_SRC = \
   examples/code/oregonator.m \
   examples/code/paramdemo.cc \
   examples/code/standalone.cc \
   examples/code/standalonebuiltin.cc \
   examples/code/stringdemo.cc \
   examples/code/structdemo.cc \
   examples/code/unwinddemo.cc
 
-EXTRA_DIST += \
+examples_EXTRA_DIST += \
   $(examples_data_SRC) \
   $(examples_code_SRC) \
   examples/code/COPYING \
   examples/module.mk
+
+EXTRA_DIST += $(examples_EXTRA_DIST)
+
+CLEANFILES += $(examples_CLEANFILES)
+DISTCLEANFILES += $(examples_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(examples_MAINTAINERCLEANFILES)
+
+examples-clean:
+	rm -f $(examples_CLEANFILES)
+
+examples-distclean: examples-clean
+	rm -f $(examples_DISTCLEANFILES)
+
+examples-maintainer-clean: examples-distclean
+	rm -f $(examples_MAINTAINERCLEANFILES)
diff --git a/libgui/graphics/module.mk b/libgui/graphics/module.mk
--- a/libgui/graphics/module.mk
+++ b/libgui/graphics/module.mk
@@ -1,19 +1,8 @@
-EXTRA_DIST += \
-  libgui/graphics/module.mk \
-  libgui/graphics/qthandles.qrc \
-  libgui/graphics/images/README \
-  libgui/graphics/images/pan.png \
-  libgui/graphics/images/rotate.png \
-  libgui/graphics/images/select.png \
-  libgui/graphics/images/zoom-in.png \
-  libgui/graphics/images/zoom-out.png \
-  $(octave_gui_graphics_UI)
-
 OCTAVE_GUI_GRAPHICS_MOC = \
   libgui/graphics/moc-annotation-dialog.cc \
   libgui/graphics/moc-Backend.cc \
   libgui/graphics/moc-ButtonControl.cc \
   libgui/graphics/moc-ContextMenu.cc \
   libgui/graphics/moc-EditControl.cc \
   libgui/graphics/moc-Figure.cc \
   libgui/graphics/moc-FigureWindow.cc \
@@ -153,12 +142,22 @@ libgui_graphics_libgui_graphics_la_CPPFL
   -I$(top_srcdir)/libinterp/octave-value
 
 libgui_graphics_libgui_graphics_la_CFLAGS = $(AM_CFLAGS) $(WARN_CFLAGS)
 
 libgui_graphics_libgui_graphics_la_CXXFLAGS = $(AM_CXXFLAGS) $(WARN_CXXFLAGS)
 
 noinst_LTLIBRARIES += libgui/graphics/libgui-graphics.la
 
-CLEANFILES += \
+libgui_EXTRA_DIST += \
+  libgui/graphics/qthandles.qrc \
+  libgui/graphics/images/README \
+  libgui/graphics/images/pan.png \
+  libgui/graphics/images/rotate.png \
+  libgui/graphics/images/select.png \
+  libgui/graphics/images/zoom-in.png \
+  libgui/graphics/images/zoom-out.png \
+  $(octave_gui_graphics_UI)
+
+libgui_CLEANFILES += \
   $(octave_gui_graphics_MOC) \
   $(octave_gui_graphics_RC) \
   $(octave_gui_graphics_UI_H)
diff --git a/libgui/module.mk b/libgui/module.mk
--- a/libgui/module.mk
+++ b/libgui/module.mk
@@ -1,10 +1,16 @@
 if AMCOND_BUILD_GUI
 
+libgui_EXTRA_DIST =
+
+libgui_CLEANFILES =
+libgui_DISTCLEANFILES =
+libgui_MAINTAINERCLEANFILES =
+
 MOC_CPPFLAGS =
 
 ## Fix for bug #42839 where -mieee CFLAG option is added to CPPFLAGS by gnulib.
 ## Users may also pass other options in CPPFLAGS that moc does not understand.
 ## Only keep moc-compatible options -Idir, -Dmacro, and -Umacro.
 MOC_OCTAVE_CPPFLAGS = $(filter -I% -D% -U%, $(AM_CPPFLAGS) $(CPPFLAGS))
 
 octlib_LTLIBRARIES += libgui/liboctgui.la
@@ -21,18 +27,16 @@ TRANSLATIONS = \
   libgui/languages/pt_BR.ts \
   libgui/languages/pt_PT.ts \
   libgui/languages/ru_RU.ts \
   libgui/languages/uk_UA.ts \
   libgui/languages/zh_CN.ts
 
 LOCALES = $(patsubst libgui/languages/%.ts, libgui/languages/%.qm, $(TRANSLATIONS))
 
-EXTRA_DIST += libgui/default-qt-settings.in $(TRANSLATIONS)
-
 include libgui/src/module.mk
 include libgui/graphics/module.mk
 include libgui/qterminal-module.mk
 
 ## liboctgui merely collects a bunch of compiled convenience libraries.
 ## It has no source code itself.
 libgui_liboctgui_la_SOURCES =
 
@@ -103,13 +107,29 @@ am__v_lrelease_0 = -silent
 am__v_lrelease_1 =
 
 %.qm: %.ts libgui/languages/$(octave_dirstamp)
 	$(AM_V_GEN)$(LRELEASE) $(AM_V_lrelease) -qm $@ $<
 
 DIRSTAMP_FILES += \
   libgui/languages/$(octave_dirstamp)
 
-DISTCLEANFILES += \
+libgui_EXTRA_DIST += \
+  $(TRANSLATIONS) \
+  libgui/default-qt-settings.in
+
+libgui_DISTCLEANFILES += \
   libgui/default-qt-settings \
   $(LOCALES)
 
+CLEANFILES += $(libgui_CLEANFILES)
+DISTCLEANFILES += $(libgui_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(libgui_MAINTAINERCLEANFILES)
+
+libgui-clean:
+	rm -f $(libgui_CLEANFILES)
+
+libgui-distclean: libgui-clean
+	rm -f $(libgui_DISTCLEANFILES)
+
+libgui-maintainer-clean: libgui-distclean
+	rm -f $(libgui_MAINTAINERCLEANFILES)
 endif
diff --git a/libgui/qterminal-module.mk b/libgui/qterminal-module.mk
--- a/libgui/qterminal-module.mk
+++ b/libgui/qterminal-module.mk
@@ -1,11 +1,8 @@
-EXTRA_DIST += \
-  libgui/qterminal-module.mk
-
 noinst_HEADERS += \
   libgui/qterminal/libqterminal/QTerminal.h \
   libgui/qterminal/libqterminal/win32/QTerminalColors.h \
   libgui/qterminal/libqterminal/win32/QWinTerminalImpl.h \
   libgui/qterminal/libqterminal/unix/BlockArray.h \
   libgui/qterminal/libqterminal/unix/Character.h \
   libgui/qterminal/libqterminal/unix/CharacterColor.h \
   libgui/qterminal/libqterminal/unix/Emulation.h \
@@ -112,9 +109,9 @@ libgui_qterminal_libqterminal_la_MOC += 
 
 DIRSTAMP_FILES += \
   libgui/qterminal/libqterminal/unix/$(octave_dirstamp)
 
 endif
 
 noinst_LTLIBRARIES += libgui/qterminal/libqterminal.la
 
-CLEANFILES += $(libgui_qterminal_libqterminal_la_MOC)
+libgui_CLEANFILES += $(libgui_qterminal_libqterminal_la_MOC)
diff --git a/libgui/src/module.mk b/libgui/src/module.mk
--- a/libgui/src/module.mk
+++ b/libgui/src/module.mk
@@ -1,14 +1,8 @@
-EXTRA_DIST += \
-  libgui/src/module.mk \
-  libgui/src/resource.qrc \
-  $(octave_gui_UI) \
-  $(octave_gui_ICONS)
-
 octave_gui_ICONS = \
   libgui/src/icons/applications-system.png \
   libgui/src/icons/bp-next.png \
   libgui/src/icons/bp-prev.png \
   libgui/src/icons/bp-rm-all.png \
   libgui/src/icons/bp-toggle.png \
   libgui/src/icons/db-cont.png \
   libgui/src/icons/db-step-in.png \
@@ -215,13 +209,18 @@ libgui_src_libgui_src_la_CPPFLAGS = \
   -I$(top_builddir)/libgnu -I$(top_srcdir)/libgnu
 
 libgui_src_libgui_src_la_CFLAGS = $(AM_CFLAGS) $(WARN_CFLAGS)
 
 libgui_src_libgui_src_la_CXXFLAGS = $(AM_CXXFLAGS) $(WARN_CXXFLAGS)
 
 noinst_LTLIBRARIES += libgui/src/libgui-src.la
 
-CLEANFILES += \
+libgui_EXTRA_DIST += \
+  libgui/src/resource.qrc \
+  $(octave_gui_UI) \
+  $(octave_gui_ICONS)
+
+libgui_CLEANFILES += \
   $(octave_gui_MOC) \
   $(octave_gui_UI_H) \
   $(octave_gui_RC)
 
diff --git a/libinterp/corefcn/module.mk b/libinterp/corefcn/module.mk
--- a/libinterp/corefcn/module.mk
+++ b/libinterp/corefcn/module.mk
@@ -1,18 +1,8 @@
-EXTRA_DIST += \
-  libinterp/corefcn/module.mk \
-  libinterp/corefcn/defaults.in.h \
-  libinterp/corefcn/graphics.in.h \
-  libinterp/corefcn/mxarray.in.h \
-  libinterp/corefcn/oct-errno.in.cc \
-  libinterp/corefcn/oct-tex-lexer.in.ll \
-  libinterp/corefcn/oct-tex-parser.in.yy \
-  libinterp/corefcn/oct-tex-symbols.in
-
 ## Options functions for Fortran packages like LSODE, DASPK.
 ## These are generated automagically by configure and Perl.
 OPT_HANDLERS = \
   libinterp/corefcn/DASPK-opts.cc \
   libinterp/corefcn/DASRT-opts.cc \
   libinterp/corefcn/DASSL-opts.cc \
   libinterp/corefcn/LSODE-opts.cc \
   libinterp/corefcn/Quad-opts.cc
@@ -360,8 +350,18 @@ libinterp_corefcn_libcorefcn_la_CFLAGS =
 libinterp_corefcn_libcorefcn_la_CXXFLAGS = $(AM_CXXFLAGS) $(WARN_CXXFLAGS) $(LLVM_CXXFLAGS)
 
 libinterp_corefcn_libtex_parser_la_SOURCES = $(TEX_PARSER_SRC)
 
 libinterp_corefcn_libtex_parser_la_CPPFLAGS = $(libinterp_liboctinterp_la_CPPFLAGS)
 
 libinterp_corefcn_libtex_parser_la_CXXFLAGS = \
   $(filter-out -Wold-style-cast, $(libinterp_corefcn_libcorefcn_la_CXXFLAGS))
+
+libinterp_EXTRA_DIST += \
+  libinterp/corefcn/defaults.in.h \
+  libinterp/corefcn/graphics.in.h \
+  libinterp/corefcn/mxarray.in.h \
+  libinterp/corefcn/oct-errno.in.cc \
+  libinterp/corefcn/oct-tex-lexer.in.ll \
+  libinterp/corefcn/oct-tex-parser.in.yy \
+  libinterp/corefcn/oct-tex-symbols.in
+
diff --git a/libinterp/module.mk b/libinterp/module.mk
--- a/libinterp/module.mk
+++ b/libinterp/module.mk
@@ -1,8 +1,14 @@
+libinterp_EXTRA_DIST =
+
+libinterp_CLEANFILES =
+libinterp_DISTCLEANFILES =
+libinterp_MAINTAINERCLEANFILES =
+
 ## Search local directories before those specified by the user.
 libinterp_liboctinterp_la_CPPFLAGS = \
   @OCTINTERP_DLL_DEFS@ \
   -I$(top_builddir)/liboctave -I$(top_srcdir)/liboctave \
   -I$(top_srcdir)/liboctave/cruft/misc \
   -I$(top_srcdir)/liboctave/array \
   -I$(top_builddir)/liboctave/numeric -I$(top_srcdir)/liboctave/numeric \
   -I$(top_builddir)/liboctave/operators -I$(top_srcdir)/liboctave/operators \
@@ -76,17 +82,17 @@ LIBINTERP_BUILT_NODISTFILES = \
   libinterp/operators/ops.cc \
   libinterp/oct-conf.h \
   libinterp/oct-conf-features.h \
   libinterp/version.h \
   $(OPT_HANDLERS) \
   $(ALL_DEF_FILES) \
   libinterp/builtins.cc
 
-EXTRA_DIST += \
+libinterp_EXTRA_DIST += \
   libinterp/DOCSTRINGS \
   libinterp/config-features.sh \
   libinterp/find-defun-files.sh \
   libinterp/gendoc.pl \
   libinterp/genprops.awk \
   libinterp/mk-errno-list \
   libinterp/mk-pkg-add \
   libinterp/mkbuiltins \
@@ -352,26 +358,41 @@ install-built-in-docstrings:
 	$(MKDIR_P) $(DESTDIR)$(octetcdir)
 	$(INSTALL_DATA) libinterp/DOCSTRINGS $(DESTDIR)$(octetcdir)/built-in-docstrings
 
 uninstall-built-in-docstrings:
 	rm -f $(DESTDIR)$(octetcdir)/built-in-docstrings
 endif
 .PHONY: install-built-in-docstrings uninstall-built-in-docstrings
 
-CLEANFILES += \
+EXTRA_DIST += $(libinterp_EXTRA_DIST)
+
+libinterp_CLEANFILES += \
   $(DLDFCN_PKG_ADD_FILE) \
   libinterp/corefcn/graphics-props.cc \
   libinterp/corefcn/oct-tex-parser.output \
   libinterp/parse-tree/oct-parse.output
 
-DISTCLEANFILES += \
+libinterp_DISTCLEANFILES += \
   libinterp/.DOCSTRINGS \
   libinterp/DOCSTRINGS \
   $(LIBINTERP_BUILT_NODISTFILES) \
   $(OCT_FILES) \
   $(LIBINTERP_TST_FILES)
 
-MAINTAINERCLEANFILES += \
+libinterp_MAINTAINERCLEANFILES += \
   $(LIBINTERP_BUILT_DISTFILES)
 
 BUILT_DISTFILES += $(LIBINTERP_BUILT_DISTFILES)
 BUILT_NODISTFILES += $(LIBINTERP_BUILT_NODISTFILES)
+
+CLEANFILES += $(libinterp_CLEANFILES)
+DISTCLEANFILES += $(libinterp_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(libinterp_MAINTAINERCLEANFILES)
+
+libinterp-clean:
+	rm -f $(libinterp_CLEANFILES)
+
+libinterp-distclean: libinterp-clean
+	rm -f $(libinterp_DISTCLEANFILES)
+
+libinterp-maintainer-clean: libinterp-distclean
+	rm -f $(libinterp_MAINTAINERCLEANFILES)
diff --git a/libinterp/octave-value/module.mk b/libinterp/octave-value/module.mk
--- a/libinterp/octave-value/module.mk
+++ b/libinterp/octave-value/module.mk
@@ -1,11 +1,8 @@
-EXTRA_DIST += \
-  libinterp/octave-value/module.mk
-
 OV_INTTYPE_INC = \
   libinterp/octave-value/ov-base-int.h \
   libinterp/octave-value/ov-base-int.cc \
   libinterp/octave-value/ov-int-traits.h \
   libinterp/octave-value/ov-int16.h \
   libinterp/octave-value/ov-int32.h \
   libinterp/octave-value/ov-int64.h \
   libinterp/octave-value/ov-int8.h \
diff --git a/libinterp/operators/module.mk b/libinterp/operators/module.mk
--- a/libinterp/operators/module.mk
+++ b/libinterp/operators/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += libinterp/operators/module.mk
-
 LIBINTERP_OPERATORS_SRC = \
   libinterp/operators/op-b-b.cc \
   libinterp/operators/op-b-bm.cc \
   libinterp/operators/op-b-sbm.cc \
   libinterp/operators/op-bm-b.cc \
   libinterp/operators/op-bm-bm.cc \
   libinterp/operators/op-bm-sbm.cc \
   libinterp/operators/op-cdm-cdm.cc \
diff --git a/libinterp/parse-tree/module.mk b/libinterp/parse-tree/module.mk
--- a/libinterp/parse-tree/module.mk
+++ b/libinterp/parse-tree/module.mk
@@ -1,13 +1,8 @@
-EXTRA_DIST += \
-  libinterp/parse-tree/module.mk \
-  libinterp/parse-tree/oct-parse.in.yy \
-  libinterp/parse-tree/octave.gperf
-
 PARSER_INC = \
   libinterp/parse-tree/lex.h \
   libinterp/parse-tree/parse.h
 
 PARSER_SRC = \
   libinterp/parse-tree/lex.ll \
   libinterp/parse-tree/oct-parse.yy
 
@@ -109,8 +104,13 @@ libinterp_parse_tree_libparse_tree_la_CF
 libinterp_parse_tree_libparse_tree_la_CXXFLAGS = $(AM_CXXFLAGS) $(WARN_CXXFLAGS)
 
 libinterp_parse_tree_libparser_la_SOURCES = $(PARSER_SRC)
 
 libinterp_parse_tree_libparser_la_CPPFLAGS = $(libinterp_liboctinterp_la_CPPFLAGS)
 
 libinterp_parse_tree_libparser_la_CXXFLAGS = \
   $(filter-out -Wold-style-cast, $(AM_CXXFLAGS))
+
+libinterp_EXTRA_DIST += \
+  libinterp/parse-tree/oct-parse.in.yy \
+  libinterp/parse-tree/octave.gperf
+
diff --git a/libinterp/template-inst/module.mk b/libinterp/template-inst/module.mk
--- a/libinterp/template-inst/module.mk
+++ b/libinterp/template-inst/module.mk
@@ -1,6 +1,4 @@
-EXTRA_DIST += libinterp/template-inst/module.mk
-
 TEMPLATE_INST_SRC = \
   libinterp/template-inst/Array-os.cc \
   libinterp/template-inst/Array-tc.cc \
   libinterp/template-inst/Array-jit.cc
diff --git a/liboctave/array/module.mk b/liboctave/array/module.mk
--- a/liboctave/array/module.mk
+++ b/liboctave/array/module.mk
@@ -1,11 +1,8 @@
-EXTRA_DIST += \
-  liboctave/array/module.mk
-
 ARRAY_INC = \
   liboctave/array/Array.h \
   liboctave/array/Array-util.h \
   liboctave/array/boolMatrix.h \
   liboctave/array/boolNDArray.h \
   liboctave/array/boolSparse.h \
   liboctave/array/CColVector.h \
   liboctave/array/CDiagMatrix.h \
diff --git a/liboctave/cruft/Faddeeva/module.mk b/liboctave/cruft/Faddeeva/module.mk
--- a/liboctave/cruft/Faddeeva/module.mk
+++ b/liboctave/cruft/Faddeeva/module.mk
@@ -1,5 +1,3 @@
-EXTRA_DIST += liboctave/cruft/Faddeeva/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/Faddeeva/Faddeeva.cc \
   liboctave/cruft/Faddeeva/Faddeeva.hh
diff --git a/liboctave/cruft/amos/module.mk b/liboctave/cruft/amos/module.mk
--- a/liboctave/cruft/amos/module.mk
+++ b/liboctave/cruft/amos/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/amos/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/amos/cacai.f \
   liboctave/cruft/amos/cacon.f \
   liboctave/cruft/amos/cbesh.f \
   liboctave/cruft/amos/cbesi.f \
   liboctave/cruft/amos/cbesj.f \
   liboctave/cruft/amos/cbesk.f \
   liboctave/cruft/amos/cbesy.f \
diff --git a/liboctave/cruft/blas-xtra/module.mk b/liboctave/cruft/blas-xtra/module.mk
--- a/liboctave/cruft/blas-xtra/module.mk
+++ b/liboctave/cruft/blas-xtra/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/blas-xtra/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/blas-xtra/ddot3.f \
   liboctave/cruft/blas-xtra/zdotc3.f \
   liboctave/cruft/blas-xtra/sdot3.f \
   liboctave/cruft/blas-xtra/cdotc3.f \
   liboctave/cruft/blas-xtra/dmatm3.f \
   liboctave/cruft/blas-xtra/zmatm3.f \
   liboctave/cruft/blas-xtra/smatm3.f \
diff --git a/liboctave/cruft/daspk/module.mk b/liboctave/cruft/daspk/module.mk
--- a/liboctave/cruft/daspk/module.mk
+++ b/liboctave/cruft/daspk/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/daspk/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/daspk/datv.f \
   liboctave/cruft/daspk/dcnst0.f \
   liboctave/cruft/daspk/dcnstr.f \
   liboctave/cruft/daspk/ddasic.f \
   liboctave/cruft/daspk/ddasid.f \
   liboctave/cruft/daspk/ddasik.f \
   liboctave/cruft/daspk/ddaspk.f \
diff --git a/liboctave/cruft/dasrt/module.mk b/liboctave/cruft/dasrt/module.mk
--- a/liboctave/cruft/dasrt/module.mk
+++ b/liboctave/cruft/dasrt/module.mk
@@ -1,6 +1,4 @@
-EXTRA_DIST += liboctave/cruft/dasrt/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/dasrt/ddasrt.f \
   liboctave/cruft/dasrt/drchek.f \
   liboctave/cruft/dasrt/droots.f
diff --git a/liboctave/cruft/dassl/module.mk b/liboctave/cruft/dassl/module.mk
--- a/liboctave/cruft/dassl/module.mk
+++ b/liboctave/cruft/dassl/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/dassl/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/dassl/ddaini.f \
   liboctave/cruft/dassl/ddajac.f \
   liboctave/cruft/dassl/ddanrm.f \
   liboctave/cruft/dassl/ddaslv.f \
   liboctave/cruft/dassl/ddassl.f \
   liboctave/cruft/dassl/ddastp.f \
   liboctave/cruft/dassl/ddatrp.f \
diff --git a/liboctave/cruft/fftpack/module.mk b/liboctave/cruft/fftpack/module.mk
--- a/liboctave/cruft/fftpack/module.mk
+++ b/liboctave/cruft/fftpack/module.mk
@@ -1,12 +1,8 @@
-EXTRA_DIST += \
-  liboctave/cruft/fftpack/module.mk \
-  liboctave/cruft/fftpack/fftpack.doc
-
 FFTPACK_SRC = \
   liboctave/cruft/fftpack/cfftb.f \
   liboctave/cruft/fftpack/cfftb1.f \
   liboctave/cruft/fftpack/cfftf.f \
   liboctave/cruft/fftpack/cfftf1.f \
   liboctave/cruft/fftpack/cffti.f \
   liboctave/cruft/fftpack/cffti1.f \
   liboctave/cruft/fftpack/passb.f \
@@ -32,12 +28,15 @@ FFTPACK_SRC = \
   liboctave/cruft/fftpack/zpassb5.f \
   liboctave/cruft/fftpack/zpassf.f \
   liboctave/cruft/fftpack/zpassf2.f \
   liboctave/cruft/fftpack/zpassf3.f \
   liboctave/cruft/fftpack/zpassf4.f \
   liboctave/cruft/fftpack/zpassf5.f
 
 if AMCOND_HAVE_FFTW
-  EXTRA_DIST += $(FFTPACK_SRC)
+  liboctave_EXTRA_DIST += $(FFTPACK_SRC)
 else
   CRUFT_SOURCES += $(FFTPACK_SRC)
 endif
+
+liboctave_EXTRA_DIST += \
+  liboctave/cruft/fftpack/fftpack.doc
diff --git a/liboctave/cruft/lapack-xtra/module.mk b/liboctave/cruft/lapack-xtra/module.mk
--- a/liboctave/cruft/lapack-xtra/module.mk
+++ b/liboctave/cruft/lapack-xtra/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/lapack-xtra/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/lapack-xtra/xclange.f \
   liboctave/cruft/lapack-xtra/xdlamch.f \
   liboctave/cruft/lapack-xtra/xdlange.f \
   liboctave/cruft/lapack-xtra/xilaenv.f \
   liboctave/cruft/lapack-xtra/xslamch.f \
   liboctave/cruft/lapack-xtra/xslange.f \
   liboctave/cruft/lapack-xtra/xzlange.f \
diff --git a/liboctave/cruft/misc/module.mk b/liboctave/cruft/misc/module.mk
--- a/liboctave/cruft/misc/module.mk
+++ b/liboctave/cruft/misc/module.mk
@@ -1,19 +1,18 @@
-EXTRA_DIST += \
-  liboctave/cruft/misc/module.mk \
-  liboctave/cruft/misc/d1mach-tst.for
-
 CRUFT_SOURCES += \
   liboctave/cruft/misc/blaswrap.c \
   liboctave/cruft/misc/cquit.c \
   liboctave/cruft/misc/d1mach.f \
   liboctave/cruft/misc/f77-extern.cc \
   liboctave/cruft/misc/f77-fcn.c \
   liboctave/cruft/misc/i1mach.f \
   liboctave/cruft/misc/lo-error.c \
   liboctave/cruft/misc/quit.cc \
   liboctave/cruft/misc/r1mach.f
 
 CRUFT_INC += \
   liboctave/cruft/misc/f77-fcn.h \
   liboctave/cruft/misc/lo-error.h \
   liboctave/cruft/misc/quit.h
+
+liboctave_EXTRA_DIST += \
+  liboctave/cruft/misc/d1mach-tst.for
diff --git a/liboctave/cruft/module.mk b/liboctave/cruft/module.mk
--- a/liboctave/cruft/module.mk
+++ b/liboctave/cruft/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/mkf77def.in
-
 nodist_liboctave_cruft_libcruft_la_SOURCES =
 
 liboctave_cruft_libcruft_la_FFLAGS = $(F77_INTEGER_8_FLAG)
 
 liboctave_cruft_libcruft_la_DEPENDENCIES = liboctave/cruft/cruft.def
 
 CRUFT_INC =
 
@@ -31,25 +29,27 @@ define gen-cruft-def
   $(SHELL) liboctave/cruft/mkf77def $(top_srcdir) $(liboctave_cruft_libcruft_la_SOURCES) > $@-t && \
   mv $@-t $@
 endef
 
 ## Special rules for files which must be built before compilation
 liboctave/cruft/cruft.def: $(liboctave_cruft_libcruft_la_SOURCES) liboctave/cruft/mkf77def
 	$(AM_V_GEN)$(gen-cruft-def)
 
-DISTCLEANFILES += \
+liboctave_DISTCLEANFILES += \
   liboctave/cruft/cruft.def \
   liboctave/cruft/mkf77def \
   liboctave/cruft/ranlib/ranlib.def \
   $(nodist_liboctave_cruft_libcruft_la_SOURCES)
 
 noinst_LTLIBRARIES += liboctave/cruft/libcruft.la
 
 liboctave_cruft_libcruft_la_SOURCES = $(CRUFT_SOURCES)
 
 liboctave_cruft_libcruft_la_CPPFLAGS = $(liboctave_liboctave_la_CPPFLAGS)
 
 liboctave_cruft_libcruft_la_CFLAGS = $(liboctave_liboctave_la_CFLAGS)
 
 liboctave_cruft_libcruft_la_CXXFLAGS = $(liboctave_liboctave_la_CXXFLAGS)
 
 liboctave_liboctave_la_LIBADD += liboctave/cruft/libcruft.la
+
+liboctave_EXTRA_DIST += liboctave/cruft/mkf77def.in
diff --git a/liboctave/cruft/odepack/module.mk b/liboctave/cruft/odepack/module.mk
--- a/liboctave/cruft/odepack/module.mk
+++ b/liboctave/cruft/odepack/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/odepack/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/odepack/cfode.f \
   liboctave/cruft/odepack/dlsode.f \
   liboctave/cruft/odepack/ewset.f \
   liboctave/cruft/odepack/intdy.f \
   liboctave/cruft/odepack/prepj.f \
   liboctave/cruft/odepack/solsy.f \
   liboctave/cruft/odepack/stode.f \
diff --git a/liboctave/cruft/ordered-qz/module.mk b/liboctave/cruft/ordered-qz/module.mk
--- a/liboctave/cruft/ordered-qz/module.mk
+++ b/liboctave/cruft/ordered-qz/module.mk
@@ -1,7 +1,5 @@
-EXTRA_DIST += liboctave/cruft/ordered-qz/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/ordered-qz/dsubsp.f \
   liboctave/cruft/ordered-qz/exchqz.f \
   liboctave/cruft/ordered-qz/ssubsp.f \
   liboctave/cruft/ordered-qz/sexchqz.f
diff --git a/liboctave/cruft/quadpack/module.mk b/liboctave/cruft/quadpack/module.mk
--- a/liboctave/cruft/quadpack/module.mk
+++ b/liboctave/cruft/quadpack/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/quadpack/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/quadpack/dqagi.f \
   liboctave/cruft/quadpack/dqagie.f \
   liboctave/cruft/quadpack/dqagp.f \
   liboctave/cruft/quadpack/dqagpe.f \
   liboctave/cruft/quadpack/dqelg.f \
   liboctave/cruft/quadpack/dqk15i.f \
   liboctave/cruft/quadpack/dqk21.f \
diff --git a/liboctave/cruft/ranlib/module.mk b/liboctave/cruft/ranlib/module.mk
--- a/liboctave/cruft/ranlib/module.mk
+++ b/liboctave/cruft/ranlib/module.mk
@@ -1,19 +1,8 @@
-EXTRA_DIST += \
-  liboctave/cruft/ranlib/module.mk \
-  liboctave/cruft/ranlib/Basegen.doc \
-  liboctave/cruft/ranlib/HOWTOGET \
-  liboctave/cruft/ranlib/README \
-  liboctave/cruft/ranlib/randlib.chs \
-  liboctave/cruft/ranlib/randlib.fdoc \
-  liboctave/cruft/ranlib/tstbot.for \
-  liboctave/cruft/ranlib/tstgmn.for \
-  liboctave/cruft/ranlib/tstmid.for
-
 RANLIB_SRC = \
   liboctave/cruft/ranlib/advnst.f \
   liboctave/cruft/ranlib/genbet.f \
   liboctave/cruft/ranlib/genchi.f \
   liboctave/cruft/ranlib/genexp.f \
   liboctave/cruft/ranlib/genf.f \
   liboctave/cruft/ranlib/gengam.f \
   liboctave/cruft/ranlib/genmn.f \
@@ -60,8 +49,18 @@ define gen-ranlib-def
 endef
 
 ## Special rules for files which must be built before compilation
 ## ranlib directory may not exist in VPATH build; create it if necessary.
 liboctave/cruft/ranlib/ranlib.def: $(RANLIB_SRC) liboctave/cruft/mkf77def
 	$(AM_V_GEN)$(gen-ranlib-def)
 
 liboctave_liboctave_la_LIBADD += liboctave/cruft/ranlib/libranlib.la
+
+liboctave_EXTRA_DIST += \
+  liboctave/cruft/ranlib/Basegen.doc \
+  liboctave/cruft/ranlib/HOWTOGET \
+  liboctave/cruft/ranlib/README \
+  liboctave/cruft/ranlib/randlib.chs \
+  liboctave/cruft/ranlib/randlib.fdoc \
+  liboctave/cruft/ranlib/tstbot.for \
+  liboctave/cruft/ranlib/tstgmn.for \
+  liboctave/cruft/ranlib/tstmid.for
diff --git a/liboctave/cruft/slatec-err/module.mk b/liboctave/cruft/slatec-err/module.mk
--- a/liboctave/cruft/slatec-err/module.mk
+++ b/liboctave/cruft/slatec-err/module.mk
@@ -1,10 +1,8 @@
-EXTRA_DIST += liboctave/cruft/slatec-err/module.mk
-
 CRUFT_SOURCES += \
   liboctave/cruft/slatec-err/fdump.f \
   liboctave/cruft/slatec-err/ixsav.f \
   liboctave/cruft/slatec-err/j4save.f \
   liboctave/cruft/slatec-err/xerclr.f \
   liboctave/cruft/slatec-err/xercnt.f \
   liboctave/cruft/slatec-err/xerhlt.f \
   liboctave/cruft/slatec-err/xermsg.f \
diff --git a/liboctave/cruft/slatec-fn/module.mk b/liboctave/cruft/slatec-fn/module.mk
--- a/liboctave/cruft/slatec-fn/module.mk
+++ b/liboctave/cruft/slatec-fn/module.mk
@@ -1,13 +1,8 @@
-EXTRA_DIST += \
-  liboctave/cruft/slatec-fn/module.mk \
-  liboctave/cruft/slatec-fn/derfc.in.f \
-  liboctave/cruft/slatec-fn/erfc.in.f
-
 CRUFT_SOURCES += \
   liboctave/cruft/slatec-fn/albeta.f \
   liboctave/cruft/slatec-fn/alngam.f \
   liboctave/cruft/slatec-fn/alnrel.f \
   liboctave/cruft/slatec-fn/algams.f \
   liboctave/cruft/slatec-fn/acosh.f \
   liboctave/cruft/slatec-fn/asinh.f \
   liboctave/cruft/slatec-fn/atanh.f \
@@ -83,8 +78,12 @@ define do-subst-isnan-macro
 endef
 
 liboctave/cruft/slatec-fn/erfc.f: liboctave/cruft/slatec-fn/erfc.in.f Makefile
 	$(AM_V_GEN)$(do-subst-isnan-macro)
 
 liboctave/cruft/slatec-fn/derfc.f: liboctave/cruft/slatec-fn/derfc.in.f Makefile
 	$(AM_V_GEN)$(do-subst-isnan-macro)
 
+liboctave_EXTRA_DIST += \
+  liboctave/cruft/slatec-fn/derfc.in.f \
+  liboctave/cruft/slatec-fn/erfc.in.f
+
diff --git a/liboctave/module.mk b/liboctave/module.mk
--- a/liboctave/module.mk
+++ b/liboctave/module.mk
@@ -1,27 +1,13 @@
-# Makefile for Octave's liboctave directory
-#
-# Copyright (C) 1993-2015 John W. Eaton
-#
-# This file is part of Octave.
-#
-# Octave is free software; you can redistribute it and/or modify it
-# under the terms of the GNU General Public License as published by the
-# Free Software Foundation; either version 3 of the License, or (at
-# your option) any later version.
-#
-# Octave is distributed in the hope that it will be useful, but WITHOUT
-# ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
-# FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
-# for more details.
-#
-# You should have received a copy of the GNU General Public License
-# along with Octave; see the file COPYING.  If not, see
-# <http://www.gnu.org/licenses/>.
+liboctave_EXTRA_DIST =
+
+liboctave_CLEANFILES =
+liboctave_DISTCLEANFILES =
+liboctave_MAINTAINERCLEANFILES =
 
 ## Search local directories before those specified by the user.
 liboctave_liboctave_la_CPPFLAGS = \
   @OCTAVE_DLL_DEFS@ \
   @CRUFT_DLL_DEFS@ \
   -I$(srcdir)/liboctave/array \
   -I$(srcdir)/liboctave/cruft/misc \
   -Iliboctave/numeric -I$(srcdir)/liboctave/numeric \
@@ -112,12 +98,26 @@ LIBOCTAVE_TST_SRC = \
 LIBOCTAVE_TST_FILES_SRC := $(shell $(top_srcdir)/build-aux/find-files-with-tests.sh "$(srcdir)" $(LIBOCTAVE_TST_SRC))
 
 LIBOCTAVE_TST_FILES := $(addsuffix -tst,$(LIBOCTAVE_TST_FILES_SRC))
 
 liboctavetestsdir := $(octtestsdir)/liboctave
 
 nobase_liboctavetests_DATA = $(LIBOCTAVE_TST_FILES)
 
-DISTCLEANFILES += \
+EXTRA_DIST += $(liboctave_EXTRA_DIST)
+
+liboctave_DISTCLEANFILES += \
   $(BUILT_INCS) \
   $(LIBOCTAVE_TST_FILES)
 
+CLEANFILES += $(liboctave_CLEANFILES)
+DISTCLEANFILES += $(liboctave_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(liboctave_MAINTAINERCLEANFILES)
+
+liboctave-clean:
+	rm -f $(liboctave_CLEANFILES)
+
+liboctave-distclean: liboctave-clean
+	rm -f $(liboctave_DISTCLEANFILES)
+
+liboctave-maintainer-clean: liboctave-distclean
+	rm -f $(liboctave_MAINTAINERCLEANFILES)
diff --git a/liboctave/numeric/module.mk b/liboctave/numeric/module.mk
--- a/liboctave/numeric/module.mk
+++ b/liboctave/numeric/module.mk
@@ -1,12 +1,8 @@
-EXTRA_DIST += \
-  liboctave/numeric/module.mk \
-  $(LIBOCTAVE_OPT_IN)
-
 LIBOCTAVE_OPT_INC = \
   liboctave/numeric/DASPK-opts.h \
   liboctave/numeric/DASRT-opts.h \
   liboctave/numeric/DASSL-opts.h \
   liboctave/numeric/LSODE-opts.h \
   liboctave/numeric/Quad-opts.h
 
 LIBOCTAVE_OPT_IN = $(LIBOCTAVE_OPT_INC:.h=.in)
@@ -185,8 +181,11 @@ liboctave_numeric_libnumeric_la_CPPFLAGS
   $(FFTW_XCPPFLAGS) \
   $(SPARSE_XCPPFLAGS)
 
 liboctave_numeric_libnumeric_la_CFLAGS = $(liboctave_liboctave_la_CFLAGS)
 
 liboctave_numeric_libnumeric_la_CXXFLAGS = $(liboctave_liboctave_la_CXXFLAGS)
 
 liboctave_liboctave_la_LIBADD += liboctave/numeric/libnumeric.la
+
+liboctave_EXTRA_DIST += $(LIBOCTAVE_OPT_IN)
+
diff --git a/liboctave/operators/module.mk b/liboctave/operators/module.mk
--- a/liboctave/operators/module.mk
+++ b/liboctave/operators/module.mk
@@ -1,23 +1,8 @@
-EXTRA_DIST += \
-  liboctave/operators/module.mk \
-  liboctave/operators/config-ops.sh \
-  liboctave/operators/mk-ops.awk \
-  liboctave/operators/mx-op-inc.mk \
-  liboctave/operators/mx-op-src.mk \
-  liboctave/operators/mx-ops \
-  liboctave/operators/smx-op-inc.mk \
-  liboctave/operators/smx-op-src.mk \
-  liboctave/operators/sparse-mk-ops.awk \
-  liboctave/operators/smx-ops \
-  liboctave/operators/vx-op-inc.mk \
-  liboctave/operators/vx-op-src.mk \
-  liboctave/operators/vx-ops
-
 include liboctave/operators/vx-op-inc.mk
 include liboctave/operators/mx-op-inc.mk
 include liboctave/operators/smx-op-inc.mk
 
 include liboctave/operators/vx-op-src.mk
 include liboctave/operators/mx-op-src.mk
 include liboctave/operators/smx-op-src.mk
 
@@ -61,23 +46,31 @@ endef
 $(SMX_OP_INC) $(SMX_OP_SRC) : liboctave/operators/sparse-mk-ops.awk liboctave/operators/smx-ops
 	$(AM_V_GEN)$(call run-mx-ops,smx,sparse-)
 
 liboctave/operators/mx-ops.h : liboctave/operators/mk-ops.awk liboctave/operators/mx-ops
 	$(AM_V_GEN)rm -f $@-t $@ && \
 	$(AWK) -f $(OP_SRCDIR)/mk-ops.awk prefix=mx make_inclusive_header=mx-ops.h $(OP_SRCDIR)/mx-ops > $@-t && \
 	mv $@-t $@
 
-DISTCLEANFILES += $(BUILT_LIBOCTAVE_OPERATORS_SOURCES)
-
 noinst_LTLIBRARIES += liboctave/operators/liboperators.la
 
 liboctave_operators_liboperators_la_SOURCES = $(LIBOCTAVE_OPERATORS_SRC)
 
 nodist_liboctave_operators_liboperators_la_SOURCES = $(BUILT_LIBOCTAVE_OPERATORS_SOURCES)
 
 liboctave_operators_liboperators_la_CPPFLAGS = $(liboctave_liboctave_la_CPPFLAGS)
 
 liboctave_operators_liboperators_la_CFLAGS = $(liboctave_liboctave_la_CFLAGS)
 
 liboctave_operators_liboperators_la_CXXFLAGS = $(liboctave_liboctave_la_CXXFLAGS)
 
 liboctave_liboctave_la_LIBADD += liboctave/operators/liboperators.la
+
+liboctave_EXTRA_DIST += \
+  liboctave/operators/config-ops.sh \
+  liboctave/operators/mk-ops.awk \
+  liboctave/operators/mx-ops \
+  liboctave/operators/sparse-mk-ops.awk \
+  liboctave/operators/smx-ops \
+  liboctave/operators/vx-ops
+
+liboctave_DISTCLEANFILES += $(BUILT_LIBOCTAVE_OPERATORS_SOURCES)
diff --git a/liboctave/system/module.mk b/liboctave/system/module.mk
--- a/liboctave/system/module.mk
+++ b/liboctave/system/module.mk
@@ -1,11 +1,8 @@
-EXTRA_DIST += \
-  liboctave/system/module.mk
-
 SYSTEM_INC = \
   liboctave/system/dir-ops.h \
   liboctave/system/file-ops.h \
   liboctave/system/file-stat.h \
   liboctave/system/lo-sysdep.h \
   liboctave/system/mach-info.h \
   liboctave/system/oct-env.h \
   liboctave/system/oct-group.h \
diff --git a/liboctave/util/module.mk b/liboctave/util/module.mk
--- a/liboctave/util/module.mk
+++ b/liboctave/util/module.mk
@@ -1,11 +1,8 @@
-EXTRA_DIST += \
-  liboctave/util/module.mk
-
 UTIL_INC = \
   liboctave/util/action-container.h \
   liboctave/util/base-list.h \
   liboctave/util/byte-swap.h \
   liboctave/util/caseless-str.h \
   liboctave/util/cmd-edit.h \
   liboctave/util/cmd-hist.h \
   liboctave/util/data-conv.h \
diff --git a/scripts/java/module.mk b/scripts/java/module.mk
--- a/scripts/java/module.mk
+++ b/scripts/java/module.mk
@@ -42,16 +42,18 @@ JAVA_IMAGES = \
   $(org_octave_dir)/images/octave.png
 
 scripts_java_JAVA_SRC = $(addprefix scripts/java/, $(JAVA_SRC))
 
 scripts_java_JAVA_CLASSES = $(addprefix scripts/java/, $(JAVA_CLASSES))
 
 scripts_java_JAVA_IMAGES = $(addprefix scripts/java/, $(JAVA_IMAGES))
 
+scripts_DISTCLEANFILES += $(addprefix $(abs_top_builddir), $(java_JAVA_IMAGES))
+
 srcdir_scripts_java_JAVA_IMAGES = $(addprefix $(srcdir)/scripts/java/, $(JAVA_IMAGES))
 
 $(scripts_java_JAVA_CLASSES) : %.class : %.java scripts/java/$(octave_dirstamp)
 	$(AM_V_GEN)$(MKDIR_P) scripts/java/$(org_octave_dir) && \
 	( cd $(srcdir)/scripts/java; "$(JAVAC)" -source 1.3 -target 1.3 -d $(abs_top_builddir)/scripts/java $(org_octave_dir)/$(<F) )
 
 scripts/java/images.stamp: $(srcdir_scripts_java_JAVA_IMAGES)
 	$(AM_V_GEN)if [ "x$(srcdir)" != "x." ]; then \
@@ -63,30 +65,30 @@ scripts/java/images.stamp: $(srcdir_scri
 if AMCOND_HAVE_JAVA
 scripts/java/octave.jar: scripts/java/images.stamp $(scripts_java_JAVA_CLASSES)
 	$(AM_V_GEN)rm -f $@-t $@ && \
 	( cd scripts/java; \
 	  "$(JAR)" cf octave.jar-t $(JAVA_CLASSES) $(JAVA_IMAGES) ) && \
 	mv $@-t $@
 endif
 
-EXTRA_DIST += \
-  $(scripts_java_JAR_FILES) \
-  $(scripts_java_JAVA_SRC) \
-  $(scripts_java_JAVA_IMAGES)
-
-CLEANFILES += \
-  $(scripts_java_JAR_FILES) \
-  $(scripts_java_JAVA_CLASSES)
-
-DISTCLEANFILES += scripts/java/images.stamp
-
 scripts_javadir = $(fcnfiledir)/java
 
 scripts_java_DATA = \
   $(scripts_java_FCN_FILES) \
   $(scripts_java_JAR_FILES)
 
 FCN_FILES += $(scripts_java_FCN_FILES)
 
 PKG_ADD_FILES += scripts/java/PKG_ADD
 
 DIRSTAMP_FILES += scripts/java/$(octave_dirstamp)
+
+scripts_EXTRA_DIST += \
+  $(scripts_java_JAR_FILES) \
+  $(scripts_java_JAVA_SRC) \
+  $(scripts_java_JAVA_IMAGES)
+
+scripts_CLEANFILES += \
+  $(scripts_java_JAR_FILES) \
+  $(scripts_java_JAVA_CLASSES)
+
+scripts_DISTCLEANFILES += scripts/java/images.stamp
diff --git a/scripts/module.mk b/scripts/module.mk
--- a/scripts/module.mk
+++ b/scripts/module.mk
@@ -1,8 +1,14 @@
+scripts_EXTRA_DIST =
+
+scripts_CLEANFILES =
+scripts_DISTCLEANFILES =
+scripts_MAINTAINERCLEANFILES =
+
 ## FIXME -- including scripts/@ftp/module.mk fails.  Is that an automake bug?
 
 FCN_FILE_DIRS += scripts/@ftp
 
 scripts_@ftp_FCN_FILES = \
   scripts/@ftp/ascii.m \
   scripts/@ftp/binary.m  \
   scripts/@ftp/cd.m  \
@@ -196,27 +202,37 @@ uninstall-pkg-add:
 
 if AMCOND_HAVE_JAVA
 scripts-dist-hook:
 else
 scripts-dist-hook:
 	@echo "Packaging distribution requires Java." ; exit 1;
 endif
 
-EXTRA_DIST += \
+scripts_EXTRA_DIST += \
   $(SCRIPTS_IMAGES) \
   $(FCN_FILES) \
   $(GEN_FCN_FILES_IN) \
   scripts/DOCSTRINGS \
   scripts/mkdoc.pl \
   scripts/mk-pkg-add
 
-DISTCLEANFILES += \
+EXTRA_DIST += $(scripts_EXTRA_DIST)
+
+scripts_DISTCLEANFILES += \
   scripts/.DOCSTRINGS \
   scripts/DOCSTRINGS \
   $(PKG_ADD_FILES) \
   $(DIRSTAMP_FILES) \
   $(GEN_FCN_FILES)
 
-scripts-distclean:
-	if [ "x$(srcdir)" != "x." ]; then \
-	  rm -f $(java_JAVA_IMAGES); \
-	fi
+CLEANFILES += $(scripts_CLEANFILES)
+DISTCLEANFILES += $(scripts_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(scripts_MAINTAINERCLEANFILES)
+
+scripts-clean:
+	rm -f $(scripts_CLEANFILES)
+
+scripts-distclean: scripts-clean
+	rm -f $(scripts_DISTCLEANFILES)
+
+scripts-maintainer-clean: scripts-distclean
+	rm -f $(scripts_MAINTAINERCLEANFILES)
diff --git a/scripts/startup/module.mk b/scripts/startup/module.mk
--- a/scripts/startup/module.mk
+++ b/scripts/startup/module.mk
@@ -15,13 +15,13 @@ STARTUP_FILE_SRC = \
   $(SYSTEM_INPUTRC_FILE_SRC)
 
 scripts_startupdir = $(fcnfiledir)/startup
 
 scripts_startup_DATA = $(scripts_startup_FCN_FILES)
 
 FCN_FILES += $(scripts_startup_FCN_FILES)
 
-EXTRA_DIST += $(STARTUP_FILE_SRC)
-
 PKG_ADD_FILES += scripts/startup/PKG_ADD
 
 DIRSTAMP_FILES += scripts/startup/$(octave_dirstamp)
+
+scripts_EXTRA_DIST += $(STARTUP_FILE_SRC)
diff --git a/src/module.mk b/src/module.mk
--- a/src/module.mk
+++ b/src/module.mk
@@ -1,8 +1,14 @@
+src_EXTRA_DIST =
+
+src_CLEANFILES =
+src_DISTCLEANFILES =
+src_MAINTAINERCLEANFILES =
+
 ## Search local directories before those specified by the user.
 
 SRC_DIR_CPPFLAGS = \
   -I$(top_srcdir)/liboctave/array \
   -I$(top_srcdir)/liboctave/cruft/misc \
   -I$(top_srcdir)/liboctave/numeric \
   -I$(top_srcdir)/liboctave/system \
   -I$(top_srcdir)/liboctave/util \
@@ -213,10 +219,22 @@ remove-version-links:
 src/octave-cli-$(version)$(EXEEXT): src/octave-cli$(EXEEXT)
 	$(AM_V_GEN)rm -f $@ && \
 	cd $(@D) && $(LN_S) $(<F) $(@F)
 
 src/octave-gui-$(version)$(EXEEXT): src/octave-gui$(EXEEXT)
 	$(AM_V_GEN)rm -f $@ && \
 	cd $(@D) && $(LN_S) $(<F) $(@F)
 
-CLEANFILES += \
-  $(OCTAVE_VERSION_LINKS)
+src_CLEANFILES += $(OCTAVE_VERSION_LINKS)
+
+CLEANFILES += $(src_CLEANFILES)
+DISTCLEANFILES += $(src_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(src_MAINTAINERCLEANFILES)
+
+src-clean:
+	rm -f $(src_CLEANFILES)
+
+src-distclean: src-clean
+	rm -f $(src_DISTCLEANFILES)
+
+src-maintainer-clean: src-distclean
+	rm -f $(src_MAINTAINERCLEANFILES)
diff --git a/test/module.mk b/test/module.mk
--- a/test/module.mk
+++ b/test/module.mk
@@ -1,8 +1,14 @@
+test_EXTRA_DIST =
+
+test_CLEANFILES =
+test_DISTCLEANFILES =
+test_MAINTAINERCLEANFILES =
+
 TEST_FILES += \
   test/fntests.m \
   test/args.tst \
   test/bug-31371.tst \
   test/bug-38576.tst \
   test/colormaps.tst \
   test/complex.tst \
   test/diag-perm.tst \
@@ -41,17 +47,17 @@ include test/bug-38691/module.mk
 include test/bug-44940/module.mk
 include test/class-concat/module.mk
 include test/classdef/module.mk
 include test/classes/module.mk
 include test/ctor-vs-method/module.mk
 include test/fcn-handle-derived-resolution/module.mk
 include test/nest/module.mk
 
-all-local: test/.gdbinit
+ALL_LOCAL_TARGETS += test/.gdbinit
 
 test/.gdbinit: etc/gdbinit
 	@$(gdbinit_install_rule)
 
 check-local: $(GENERATED_TEST_FILES) $(OCTAVE_INTERPRETER_TARGETS) test/$(octave_dirstamp)
 	cd test && ../run-octave $(RUN_OCTAVE_OPTIONS) --norc --silent --no-history $(abs_top_srcdir)/test/fntests.m $(abs_top_srcdir)/test
 
 if AMCOND_HAVE_LLVM
@@ -72,36 +78,48 @@ GENERATED_BC_OVERLOADS_FILES := \
 
 $(GENERATED_BC_OVERLOADS_FILES): test/bc-overload-tests.stamp
 
 test/bc-overload-tests.stamp: test/build-bc-overload-tests.sh test/bc-overloads-expected test/$(octave_dirstamp)
 	$(AM_V_GEN)rm -f $@ && \
 	$(srcdir)/test/build-bc-overload-tests.sh test $(srcdir)/test/bc-overloads-expected && \
 	touch $@
 
-GENERATED_TEST_FILES = test/sparse.tst test/bc-overload-tests.stamp
-
-BUILT_SOURCES += \
+GENERATED_TEST_FILES = \
   test/sparse.tst \
   test/bc-overload-tests.stamp
 
-EXTRA_DIST += \
-  test/build-sparse-tests.sh \
-  test/build-bc-overload-tests.sh \
-  test/bc-overloads-expected \
-  test/build_bc_overloads_expected.m \
-  $(TEST_FILES)
-
-CLEANFILES += \
-  $(GENERATED_BC_OVERLOADS_FILES) \
-  test/sparse.tst \
-  test/bc-overload-tests.stamp
-
-DISTCLEANFILES += \
-  test/.gdbinit \
-  test/fntests.log
-
 fixedtestsdir := $(octtestsdir)/fixed
 
 nobase_fixedtests_DATA = \
   test/sparse.tst \
   $(GENERATED_BC_OVERLOADS_FILES) \
   $(filter-out test/fntests.m, $(TEST_FILES))
+
+BUILT_SOURCES += $(GENERATED_TEST_FILES)
+
+test_EXTRA_DIST += \
+  test/build-sparse-tests.sh \
+  test/build-bc-overload-tests.sh \
+  test/bc-overloads-expected \
+  test/build_bc_overloads_expected.m \
+  $(TEST_FILES)
+
+test_CLEANFILES += \
+  $(GENERATED_BC_OVERLOADS_FILES) \
+  $(GENERATED_TEST_FILES)
+
+test_DISTCLEANFILES += \
+  test/.gdbinit \
+  test/fntests.log
+
+CLEANFILES += $(test_CLEANFILES)
+DISTCLEANFILES += $(test_DISTCLEANFILES)
+MAINTAINERCLEANFILES += $(test_MAINTAINERCLEANFILES)
+
+test-clean:
+	rm -f $(test_CLEANFILES)
+
+test-distclean: test-clean
+	rm -f $(test_DISTCLEANFILES)
+
+test-maintainer-clean: test-distclean
+	rm -f $(test_MAINTAINERCLEANFILES)
